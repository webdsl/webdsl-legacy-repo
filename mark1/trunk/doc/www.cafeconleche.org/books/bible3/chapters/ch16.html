<html><head><title>XSL Formatting Objects</title></head><body text="#000000"> <div style="text-align: center">                [ <a href="../../../index.html">Cafe con Leche</a>          | <a href="../index.html">XML Bible Home Page</a>       | Order  from  <a href="http://www.amazon.com/exec/obidos/ASIN/0764549863/ref=nosim/cafeaulaitA/">amazon.com</a>  |  <a href="http://www.wiley.com/WileyCDA/WileyTitle/productCd-0764549863.html">Publisher Page</a> ]         </div><hr /><b><font face="Arial" size=2><p>In This Chapter</p></b></font><ul>	<li><p>Formatting objects and their properties</p></li>	<li><p>Page layout</p></li>	<li><p>Content</p></li>	<li><p>Leaders and rules</p></li>	<li><p>Graphics</p></li>	<li><p>Links</p></li>	<li><p>Lists</p></li>	<li><p>Tables</p></li>	<li><p>Inlines</p></li>	<li><p>Footnotes</p></li>	<li><p>Floats</p></li>	<li><p>Formatting properties</p></li></ul><h1>XSL Formatting Objects</h1><p>XSL Formatting Objects (XSL-FO) are the second half of the Extensible Stylesheet Language (XSL). XSL-FO is an XML application that describes how pages will look when presented to a reader. A style sheet uses the XSL transformation language to transform an XML document in a semantic vocabulary into a new XML document that uses the XSL-FO presentational vocabulary. While one can hope that web browsers will one day know how to directly display data marked up with XSL formatting objects, for now, an additional step is necessary in which the output document is further transformed into some other format, such as Adobe&#146;s PDF.</p><h2>Formatting Objects and Their Properties</h2><p>XSL-FO provides a more sophisticated visual layout model than HTML+CSS. Formatting supported by XSL-FO, but not supported by HTML+CSS, includes right-to-left and top-to-bottom text, footnotes, margin notes, page numbers in cross-references, and more. In particular, while Cascading Style Sheets (CSS) is primarily intended for use on the Web, XSL-FO is designed for broader use. You should, for example, be able to write an XSL style sheet that uses formatting objects to lay out an entire printed book. A different style sheet should be able to transform the same XML document into a web site.</p><dir><b><font face="Arial" size=1 color="#000080"><p>Caution</p></b></font><p>This chapter is based on the October 15, 2001, Recommendation of the XSL specification. However, most software does not implement all of the final Recommendation for XSL. In fact, so far, only a few standalone programs convert XSL-FO documents into PDF files. There are no web browsers that can display a document written with XSL formatting objects.</p></dir><p>There are exactly 56 XSL formatting object elements. These are placed in the <code>http://www.w3.org/1999/XSL/Format</code> namespace. At least 99 percent of the time, the chosen prefix is <code>fo</code>. In this chapter, I use the <code>fo</code> prefix to indicate this namespace without further comment.</p><p>Of the 56 elements, most signify various kinds of rectangular areas. Most of the rest are containers for rectangular areas and spaces. In alphabetical order, these formatting objects are:</p><ul><li><code>fo:basic-link</li><li>fo:bidi-override</li><li>fo:block</li><li>fo:block-container</li><li>fo:character</li><li>fo:color-profile</li><li>fo:conditional-page-master-reference</li><li>fo:declarations</li><li>fo:external-graphic</li><li>fo:float</li><li>fo:flow</li><li>fo:footnote</li><li>fo:footnote-body</li><li>fo:initial-property-set</li><li>fo:inline</li><li>fo:inline-container</li><li>fo:instream-foreign-object</li><li>fo:layout-master-set</li><li>fo:leader</li><li>fo:list-block</li><li>fo:list-item</li><li>fo:list-item-body</li><li>fo:list-item-label</li><li>fo:marker</li><li>fo:multi-case</li><li>fo:multi-properties</li><li>fo:multi-property-set</li><li>fo:multi-switch</li><li>fo:multi-toggle</li><li>fo:page-number</li><li>fo:page-number-citation</li><li>fo:page-sequence</li><li>fo:page-sequence-master</li><li>fo:region-after</li><li>fo:region-before</li><li>fo:region-body</li><li>fo:region-end</li><li>fo:region-start</li><li>fo:repeatable-page-master-alternatives</li><li>fo:repeatable-page-master-reference</li><li>fo:retrieve-marker</li><li>fo:root</li><li>fo:simple-page-master</li><li>fo:single-page-master-reference</li><li>fo:static-content</li><li>fo:table</li><li>fo:table-and-caption</li><li>fo:table-body</li><li>fo:table-caption</li><li>fo:table-cell</li><li>fo:table-column</li><li>fo:table-footer</li><li>fo:table-header</li><li>fo:table-row</li><li>fo:title</li><li>fo:wrapper</li></ul></code><p>The XSL formatting model is based on rectangular boxes called <i>areas</i> that can contain text, empty space, images, or other formatting objects. As with CSS boxes, an area has borders and padding on each of its sides, although CSS&#146;s margins are replaced by XSL&#146;s space-before and space-after. An XSL formatter reads the formatting objects to determine which areas to place where on the page. Many formatting objects produce single areas (at least most of the time); but because of page breaks, word wrapping, hyphenation, and other details that must be taken into account when fitting an indefinite amount of text into a finite amount of space, some formatting objects do occasionally generate more than one area.</p><p>The formatting objects differ primarily in what they represent. For example, the <code>fo:list-item-label</code> formatting object is a box that contains a bullet, a number, or another indicator placed in front of a list item. A <code>fo:list-item-body</code> formatting object is a box that contains the text, sans label, of the list item. And a <code>fo:list-item</code> formatting object is a box that contains both the <code>fo:list-item-label</code> and <code>fo:list-item-body</code> formatting objects.</p><p>When processed, the formatting objects document is broken up into pages. A web browser window will normally be treated as one very long page. A print format will often contain many individual pages. Each page contains a number of areas. There are four primary kinds of areas:</p><ol><li>Regions</li><li>Block areas</li><li>Line areas</li><li>Inline areas</li></ol><p>These form a rough hierarchy. Regions contain block areas. Block areas contain other block areas, line areas, and content. Line areas contain inline areas. Inline areas contain other inline areas and content. More specifically:</p><ul><li>A region is the highest-level container in XSL-FO. You can think of a page of this book as containing three regions: the header, the main body of the page, and the footer. Formatting objects that produce regions include <code>fo:region-body</code>, <code>fo:region-before</code>, <code>fo:region-after</code>, <code>fo:region-start</code>, and <code>fo:region-end</code>.</li><li>A block area represents a block-level element, such as a paragraph or a list item. Although block areas may contain other block areas, there should always be a line break before the start and after the end of each block area. A block area, rather than being precisely positioned by coordinates, is placed sequentially in the area that contains it. As other block areas are added and deleted before it or within it, the block area&#146;s position shifts as necessary to make room. A block area may contain parsed character data, inline areas, line areas, and other block areas that are sequentially arranged in the containing block area. Formatting objects that produce block areas include <code>fo:block</code>, <code>fo:table-and-caption</code>, and <code>fo:list-block</code>.</li><li>A line area represents a line of text inside a block. For example, each of the lines in this list item is a line area. Line areas can contain inline areas and inline spaces. There are no formatting objects that correspond to line areas. Instead, the formatting engine calculates the line areas as it decides how to wrap lines inside block areas.</li><li>Inline areas are parts of a line such as a single character, a footnote reference, or a mathematical equation. Inline areas can contain other inline areas and raw text. Formatting objects that produce inline areas include <code>fo:character</code>, <code>fo:external-graphic</code>, <code>fo:inline</code>, <code>fo:instream-foreign-object</code>, <code>fo:leader</code>, and <code>fo:page-number</code>.</li></ul><h3>Formatting properties</h3><p>When taken as a whole, the various formatting objects in an XSL-FO document specify the order in which content is to be placed on pages. However, <i>formatting properties</i> specify the details of formatting, such as size, position, font, color, and a lot more. Formatting properties are represented as attributes on the individual formatting object elements.</p><p>The details of many of these properties should be familiar from CSS. Work is ongoing to ensure that CSS and XSL-FO use the same names to mean the same things. For example, the CSS <code>font-family</code> property means the same thing as the XSL <code>font-family</code> property; and although the syntax for assigning values to properties is different in CSS and XSL-FO, the meaning of the values themselves is the same. To indicate that the <code>fo:block</code> element is formatted in some approximation of Times, you might use this CSS rule:</p><pre>fo:block {font-family: 'New York', 'Times New Roman', serif}</pre><p>The XSL-FO equivalent is to include a <code>font-family</code> attribute in the <code>fo:block</code> start-tag in this way:</p><pre>&lt;fo:block font-family="'New York', 'Times New Roman', serif"&gt;</pre><p>Although this is superficially different, the style name (<code>font-family</code>) and the style value (<code>'New York'</code>, <code>'Times New Roman'</code>, <code>serif</code>) are the same. CSS&#146;s <code>font-family</code> property is specified as a list of font names, separated by commas, in order from first choice to last choice. XSL-FO&#146;s <code>font-family</code> property is specified as a list of font names, separated by commas, in order from first choice to last choice. Both CSS and XSL-FO quote font names that contain white space. Both CSS and XSL-FO understand the keyword <code>serif</code> to mean an arbitrary serif font.</p><p>Of course, XSL formatting objects support many properties that have no CSS equivalent, such as <code>destination-placement-offset</code>, <code>block-progression-dimension</code>, <code>character</code>, and <code>hyphenation-keep</code>. You need to learn these to take full advantage of XSL. The standard XSL-FO properties follow:</p><ul><li><code>absolute-position</li><li>active-state</li><li>alignment-adjust</li><li>alignment-baseline</li><li>auto-restore</li><li>azimuth</li><li>background</li><li>background-attachment</li><li>background-color</li><li>background-image</li><li>background-position</li><li>background-position-horizontal</li><li>background-position-vertical</li><li>background-repeat</li><li>baseline-shift</li><li>blank-or-not-blank</li><li>block-progression-dimension</li><li>border</li><li>border-after-color</li><li>border-after-precedence</li><li>border-after-style</li><li>border-after-width</li><li>border-before-color</li><li>border-before-precedence</li><li>border-before-style</li><li>border-before-width</li><li>border-bottom</li><li>border-bottom-color</li><li>border-bottom-style</li><li>border-bottom-width</li><li>border-collapse</li><li>border-color</li><li>border-end-color</li><li>border-end-precedence</li><li>border-end-style</li><li>border-end-width</li><li>border-left</li><li>border-left-color</li><li>border-left-style</li><li>border-left-width</li><li>border-right</li><li>border-right-color</li><li>border-right-style</li><li>border-right-width</li><li>border-separation</li><li>border-spacing</li><li>border-start-color</li><li>border-start-precedence</li><li>border-start-style</li><li>border-start-width</li><li>border-style</li><li>border-top</li><li>border-top-color</li><li>border-top-style</li><li>border-top-width</li><li>border-width</li><li>bottom</li><li>break-after</li><li>break-before</li><li>caption-side</li><li>case-name</li><li>case-title</li><li>character</li><li>clear</li><li>clip</li><li>color</li><li>color-profile-name</li><li>column-count</li><li>column-gap</li><li>column-number</li><li>column-width</li><li>content-height</li><li>content-type</li><li>content-width</li><li>country</li><li>cue</li><li>cue-after</li><li>cue-before</li><li>destination-placement-offset</li><li>direction</li><li>display-align</li><li>dominant-baseline</li><li>elevation</li><li>empty-cells</li><li>end-indent</li><li>ends-row</li><li>extent</li><li>external-destination</li><li>float</li><li>flow-name</li><li>font</li><li>font-family</li><li>font-selection-strategy</li><li>font-size</li><li>font-size-adjust</li><li>font-stretch</li><li>font-style</li><li>font-variant</li><li>font-weight</li><li>force-page-count</li><li>format</li><li>glyph-orientation-horizontal</li><li>glyph-orientation-vertical</li><li>grouping-separator</li><li>grouping-size</li><li>height</li><li>hyphenate</li><li>hyphenation-character</li><li>hyphenation-keep</li><li>hyphenation-ladder-count</li><li>hyphenation-push-character-count</li><li>hyphenation-remain-character-count</li><li>id</li><li>indicate-destination</li><li>initial-page-number</li><li>inline-progression-dimension</li><li>internal-destination</li><li>keep-together</li><li>keep-with-next</li><li>keep-with-previous</li><li>language</li><li>last-line-end-indent</li><li>leader-alignment</li><li>leader-length</li><li>leader-pattern</li><li>leader-pattern-width</li><li>left</li><li>letter-spacing</li><li>letter-value</li><li>linefeed-treatment</li><li>line-height</li><li>line-height-shift-adjustment</li><li>line-stacking-strategy</li><li>margin</li><li>margin-bottom</li><li>margin-left</li><li>margin-right</li><li>margin-top</li><li>marker-class-name</li><li>master-name</li><li>master-reference</li><li>max-height</li><li>maximum-repeats</li><li>max-width</li><li>media-usage</li><li>min-height</li><li>min-width</li><li>number-columns-repeated</li><li>number-columns-spanned</li><li>number-rows-spanned</li><li>odd-or-even</li><li>orphans</li><li>overflow</li><li>padding</li><li>padding-after</li><li>padding-before</li><li>padding-bottom</li><li>padding-end</li><li>padding-left</li><li>padding-right</li><li>padding-start</li><li>padding-top</li><li>page-break-after</li><li>page-break-before</li><li>page-break-inside</li><li>page-height</li><li>page-position</li><li>page-width</li><li>pause</li><li>pause-after</li><li>pause-before</li><li>pitch</li><li>pitch-range</li><li>play-during</li><li>position</li><li>precedence</li><li>provisional-distance-between-starts</li><li>provisional-label-separation</li><li>reference-orientation</li><li>ref-id</li><li>region-name</li><li>relative-align</li><li>relative-position</li><li>rendering-intent</li><li>retrieve-boundary</li><li>retrieve-class-name</li><li>retrieve-position</li><li>richness</li><li>right</li><li>role</li><li>rule-style</li><li>rule-thickness</li><li>scaling</li><li>scaling-method</li><li>score-spaces</li><li>script</li><li>show-destination</li><li>size</li><li>source-document</li><li>space-after</li><li>space-before</li><li>space-end</li><li>space-start</li><li>space-treatment</li><li>span</li><li>speak</li><li>speak-header</li><li>speak-numeral</li><li>speak-punctuation</li><li>speech-rate</li><li>src</li><li>start-indent</li><li>starting-state</li><li>starts-row</li><li>stress</li><li>suppress-at-line-break</li><li>switch-to</li><li>table-layout</li><li>table-omit-footer-at-break</li><li>table-omit-header-at-break</li><li>target-presentation-context</li><li>target-processing-context</li><li>target-stylesheet</li><li>text-align</li><li>text-align-last</li><li>text-altitude</li><li>text-decoration</li><li>text-depth</li><li>text-indent</li><li>text-shadow</li><li>text-transform</li><li>top</li><li>treat-as-word-space</li><li>unicode-bidi</li><li>vertical-align</li><li>visibility</li><li>voice-family</li><li>volume</li><li>white-space</li><li>white-space-collapse</li><li>widows</li><li>width</li><li>word-spacing</li><li>wrap-option</li><li>writing-mode</li><li>xml:lang</li><li>z-index</li></code></ul><h3>Transforming to formatting objects</h3><p>XSL-FO is a complete XML vocabulary for laying out text on a page. An XSL-FO document is simply a well-formed XML document that uses this vocabulary. That means it has an XML declaration, a root element, child elements, and so forth. It must adhere to all the well-formedness rules of any XML document, or formatters will not accept it. By convention, a file that contains XSL formatting objects has the three-letter extension .fob or the two-letter extension .fo. However, it might have the suffix .xml because it also is a well-formed XML file.</p><p>Listing 16-1 is a simple document marked up using XSL formatting objects. The root of the document is <code>fo:root</code>. This element contains a <code>fo:layout-master-set</code> and a <code>fo:page-sequence</code>. The <code>fo:layout-master-set</code> element contains <code>fo:simple-page-master</code> child elements. Each <code>fo:simple-page-master</code> describes a kind of page on which content will be placed. Here there&#146;s only one very simple page, but more complex documents can have different master pages for first, right, and left, body pages, front matter, back matter, and more, each with a potentially different set of margins, page numbering, and other features. The name by which the page master will be referenced is given in the <code>master-name</code> attribute.</p><p>Content is placed on copies of the master page using a <code>fo:page-sequence</code>. The <code>fo:page-sequence</code> element has a <code>master-reference</code> attribute naming the master page to be used. Its <code>fo:flow</code> child element holds the actual content to be placed on the pages. The content is given as two <code>fo:block</code> children, each with a <code>font-size</code> property of 20 points, a <code>font-family</code> property of <code>serif</code>, and a line height of 30 points.</p><font face="Arial"><p>Listing 16-1: A Simple XSL-FO Document</p></font></font><pre>&lt;?xml version="1.0"?&gt;&lt;fo:root xmlns:fo="http://www.w3.org/1999/XSL/Format"&gt;  &lt;fo:layout-master-set&gt;    &lt;fo:simple-page-master master-name="only"&gt;      &lt;fo:region-body/&gt;    &lt;/fo:simple-page-master&gt;  &lt;/fo:layout-master-set&gt;  &lt;fo:page-sequence master-reference="only"&gt;    &lt;fo:flow flow-name="xsl-region-body"&gt;      &lt;fo:block font-size="20pt" font-family="serif"                line-height="30pt"&gt;        Hydrogen      &lt;/fo:block&gt;      &lt;fo:block font-size="20pt" font-family="serif"                line-height="30pt" &gt;        Helium      &lt;/fo:block&gt;    &lt;/fo:flow&gt;  &lt;/fo:page-sequence&gt;&lt;/fo:root&gt;</pre><p>Although you could write a document such as Listing 16-1 by hand, doing so would lose all the benefits of content-format independence achieved by XML. Normally, you write an XSLT style sheet that transforms an XML source document into XSL-FO. Listing 16-2 is the XSLT style sheet that produced Listing 16-1 by transforming the previous chapter&#146;s Listing 15-1.</p><font face="Arial"><p>Listing 16-2: A Transformation from a Source Vocabulary to XSL Formatting Objects</p></font></font><pre>&lt;?xml version="1.0"?&gt;&lt;xsl:stylesheet version="1.0"  xmlns:xsl="http://www.w3.org/1999/XSL/Transform"  xmlns:fo="http://www.w3.org/1999/XSL/Format"&gt;  &lt;xsl:output indent="yes"/&gt;  &lt;xsl:template match="/"&gt;    &lt;fo:root xmlns:fo="http://www.w3.org/1999/XSL/Format"&gt;      &lt;fo:layout-master-set&gt;        &lt;fo:simple-page-master master-name="only"&gt;          &lt;fo:region-body/&gt;        &lt;/fo:simple-page-master&gt;      &lt;/fo:layout-master-set&gt;      &lt;fo:page-sequence master-reference="only"&gt;        &lt;fo:flow flow-name="xsl-region-body"&gt;          &lt;xsl:apply-templates select="//ATOM"/&gt;        &lt;/fo:flow&gt;      &lt;/fo:page-sequence&gt;    &lt;/fo:root&gt;  &lt;/xsl:template&gt;  &lt;xsl:template match="ATOM"&gt;    &lt;fo:block font-size="20pt" font-family="serif"              line-height="30pt"&gt;      &lt;xsl:value-of select="NAME"/&gt;    &lt;/fo:block&gt;  &lt;/xsl:template&gt;&lt;/xsl:stylesheet&gt;</pre><h3>Using FOP</h3><p>At the time of this writing, no web browser can directly display XML documents transformed into XSL formatting objects. However, there are several applications that can convert an XSL-FO document into a viewable format such as PDF or TeX. The one used here is the XML Apache project&#146;s open source FOP. FOP is a command-line Java program that converts XSL-FO documents to PDF files as well as several other formats, including PCL, SVG, plain text, and FrameMaker MIF. At the time of this writing, the most recent version of FOP is 0.20.5, which incompletely supports a subset of the formatting objects and properties in the XSL 1.0 Recommendation. You can download the latest version of FOP from <code>http://xml.apache.org/fop/</code>.</p><p>FOP is a Java program that should run on any platform with a reasonably compatible Java 1.2 or later virtual machine. To install it, just unpack the distribution and add the directory where you put it (I use /usr/local/xml/fop on UNIX and C:\xml\fop on Windows) to your path.</p><p>The directory where you installed it contains, among other files, fop.bat and fop.sh. Use fop.bat for Windows and fop.sh for UNIX. Add the appropriate script for your platform to your path environment variable. Then run it from the command line with arguments specifying the input and output files, like this:</p><pre>C:\&gt; fop -fo 16-1.fo -pdf 16-1.pdf</pre><p>The output will look something like this:</p><pre>[INFO] Using org.apache.xerces.parsers.SAXParser as SAX2 Parser[INFO] FOP 0.20.5[INFO] Using org.apache.xerces.parsers.SAXParser as SAX2 Parser[INFO] building formatting object tree[INFO] setting up fonts[INFO] [1][INFO] Parsing of document complete, stopping renderer</pre><p>Here, 16-1.fo is the input XML file that uses the formatting object vocabulary. 16-1.pdf is the output PDF file that can be displayed and printed by Adobe Acrobat, Preview, GhostView, or other programs that read PDF files.</p><p>Although PDF files are themselves ASCII text, this isn&#146;t a book about PostScript, so there&#146;s nothing to be gained by showing you the exact output of the preceding command. If you&#146;re curious, open the PDF file in any text editor. Instead, Figure 16-1 shows the rendered file displayed in Acrobat Reader.</p><p><img src="Image6.gif" width=384 height=287></p><p>Figure 16-1: The PDF file displayed in Acrobat Reader</p><p>PDF files are not the only destination format for XML documents styled with XSL formatting objects. FOP can also transform XSL-FO documents into PCL, MIF, SVG, and plain-text files. In the near future, it's expected to be able to produce RTF documents, as well. It can also display the file directly in a window, as shown in Figure 16-2. Other XSL-FO tools can produce other formats.</p><p><img src="Image7.gif" width=379 height=476></p><p>Figure 16-2: FOP rendering the XSL-FO document in a GUI</p><h2>Page Layout</h2><p>The root element of a formatting objects document is <code>fo:root</code>. This element contains one <code>fo:layout-master-set</code> element and one or more <code>fo:page-sequence</code> elements. The <code>fo:page-sequence</code> elements contain content; that is, text and images to be placed on the pages. The <code>fo:layout-master-set</code> contains templates for the pages that will be created. When the formatter reads an XSL-FO document, it creates a page based on the first template in the <code>fo:layout-master-set</code>. Then it fills it with content from the <code>fo:page-sequence</code>. When it&#146;s filled the first page, it instantiates a second page and fills it with content. The process continues until the formatter runs out of content.</p><h3>The root element</h3><p>The <code>fo:root</code> element generally has an <code>xmlns:fo</code> attribute with the value <code>http://www.w3.org/1999/XSL/Format</code> and may (though it generally does not) have an <code>id</code> attribute. The <code>fo:root</code> element exists just to declare the namespace and be the document root. It has no direct effect on page layout or formatting.</p><h3>Simple page masters</h3><p>The page templates are called <i>page masters</i>. Page masters are similar in purpose to QuarkXPress master pages or PowerPoint slide masters. Each defines a general layout for a page including its margins, the sizes of the header, footer, and body area of the page, and so forth. Each actual page in the rendered document is based on one master page, and inherits certain properties like margins, page numbering, and layout from that master page. XSL-FO 1.0 defines exactly one kind of page master, the <code>fo:simple-page-master</code>, which represents a rectangular page. The <code>fo:layout-master-set</code> contains one or more <code>fo:simple-page-master</code> elements that define master pages.</p><dir><b><font face="Arial" size=1 color="#000080"><p>Note</p></b></font><p>Future versions of XSL-FO will add other kinds of page masters, possibly including nonrectangular pages.</p></dir><p>Each master page is represented by a <code>fo:simple-page-master</code> element. A <code>fo:simple-page-master</code> element defines a page layout, including the size of its before region, body region, after region, end region, and start region. Figure 16-3 shows the typical layout of these parts. One thing that may not be obvious from this picture is that the body region overlaps the other four regions (though not the page margins); that is, the body is everything inside the thick black line including the start, end, before, and after regions.</p><p><img src="picture3.jpg"></p><p>Figure 16-3: The layout of the parts of a simple page of English text</p><dir><b><font face="Arial" size=1 color="#000080"><p>Note</p></b></font><p>In normal English text, the end region is the right side of the page, and the start region is the left side of the page. This is reversed in Hebrew or Arabic text, because these languages are written from right to left. In most modern languages, the before region is the header and the after region is the footer, but this could be reversed in a language that writes from bottom to top.</p></dir></font><p>Simple page master properties</p><p>The <code>fo:simple-page-master</code> element has three main attributes:</p><ul><li><code>master-name</code>&#150;The name by which page sequences will reference this master page</li><li><code>page-height</code>&#150;The height of the page</li><li><code>page-width</code>&#150;The width of the page</li></ul><p>If the <code>page-height</code> and <code>page-width</code> are not provided, the formatter chooses a reasonable default based on the media in use (for example, 8.5" x11" for paper).</p><p>Other attributes commonly applied to page masters include the following:</p><ul><li>The <code>margin-bottom</code>, <code>margin-left</code>, <code>margin-right</code>, and <code>margin-top</code> attributes, or the shorthand <code>margin</code> attribute</li><li>The <code>writing-mode</code> attribute that determines which direction text flows on the page, for example, left to right, right to &#151;left, or top to bottom</li><li>The <code>reference-orientation</code> attribute that specifies in 90-degree increments whether and how much the content is rotated</li></ul><p>For example, here is a <code>fo:layout-master-set</code> containing one <code>fo:simple-page-master</code> named <code>US-Letter</code>. It specifies an 8.5 x 11-inch page with half-inch margins on each side. It contains a single region, the body, into which all content will be placed.</p><pre>&lt;fo:layout-master-set&gt;  &lt;fo:simple-page-master  master-name="US-Letter"     page-height="11in"   page-width="8.5in"     margin-top="0.5in"   margin-bottom="0.5in"     margin-left="0.5in"  margin-right="0.5in"&gt;    &lt;fo:region-body/&gt;  &lt;/fo:simple-page-master&gt;&lt;/fo:layout-master-set&gt;</pre><h3>Regions</h3><p>The designer sets the size of the body (center) region, header, footer, end region, and start region, as well as the distances between them, by adding region child elements to the <code>fo:simple-page-master</code>. These are as follows:</p><ul><li><code>fo:region-before</li><li>fo:region-after</li><li>fo:region-body</li><li>fo:region-start</li><li>fo:region-end</li></code></ul><p>The <code>fo:region-before</code> and <code>fo:region-after</code> elements each have an <code>extent</code> attribute that gives the height of these regions. Their width extends from the left side of the page to the right side. The <code>fo:region-start</code> and <code>fo:region-end</code> elements each have an <code>extent</code> attribute that specifies their widths. Their height extends from the bottom of the start region to the top of the end region. (This assumes normal Western text. Details would be rotated in Chinese, Hebrew, or any other non-right-to-left-top-to-bottom script.)</p><p>The <code>fo:region-body</code> does not have an <code>extent</code> attribute. Instead, the size of the body is everything inside the page margins. Thus, the region body overlaps the other four regions on the page. If you place text into the body and the other four regions, text will be drawn on top of other content. To avoid this, you must set the left margin of the body to be as large or larger than the extent of the start region, the top margin of the body to be as large or larger than the extent of the before region, and so on.</p><p>Each of the five regions of a simple page master may be filled with content when the document is processed. However, the region elements do not contain that content. Instead, they simply give the dimensions of the boxes the formatter will build to put content in. The content is copied from a <code>fo:flow</code> or <code>fo:static-content</code> element elsewhere in the document. The region elements are blueprints for the boxes, not the boxes themselves.</p><p>For example, this <code>fo:simple-page-master</code> defines a page with 1 inch before and after regions. The region body extends vertically from the bottom of the before region to the top of the after region. It extends horizontally from the left side of the page to the right side of the page because there is no start or end region.</p><pre>  &lt;fo:simple-page-master master-name="table_page"&gt;    &lt;fo:region-before extent="1.0in"/&gt;    &lt;fo:region-body margin-top="1.0in" margin-bottom="1.0in"/&gt;    &lt;fo:region-after extent="1.0in"/&gt;  &lt;/fo:simple-page-master&gt;</pre><p>For another example, here is a <code>fo:layout-master-set</code> that makes all outer regions 1 inch. Furthermore, the page itself has a half-inch margin on all sides.</p><pre>&lt;fo:layout-master-set&gt;  &lt;fo:simple-page-master    master-name="only"       page-width="8.5in"   page-height="11in"       margin-top="0.5in"   margin-bottom="0.5in"       margin-left="0.5in"  margin-right="0.5in"&gt;    &lt;fo:region-start  extent="1.0in"/&gt;    &lt;fo:region-before extent="1.0in"/&gt;    &lt;fo:region-body   margin="1.0in"/&gt;    &lt;fo:region-end    extent="1.0in"/&gt;    &lt;fo:region-after  extent="1.0in"/&gt;  &lt;/fo:simple-page-master&gt;&lt;/fo:layout-master-set&gt;</pre><p>The body regions from pages based on this page master will be 5.5 inches wide and 8 inches high. That&#146;s calculated by subtracting the sum of the body region&#146;s margins and the page margins from the size of the page.</p><h3>Page sequences</h3><p>In addition to a <code>fo:layout-master-set</code>, each formatting object document contains one or more <code>fo:page-sequence</code> elements. Each page in the sequence has an associated page master that defines how the page will look. The <code>master-reference</code> attribute of the <code>fo:page-sequence</code> element determines which page master this is. This attribute must match the name of a page master in the <code>fo:layout-master-set</code>. Listing 16-1 used a <code>fo:simple-master-page</code> named <code>only</code> to fill this role, but it is not uncommon to have more than one master page. In this case, the master pages might be grouped as part of a <code>fo:page-sequence-master</code> instead. For example, you could have one master page for the first page of each chapter, a different one for all the subsequent left-hand pages, and a third for all the subsequent right-hand pages. Or, there could be one simple page master for a table of contents, another for body text, and a third for the index. In this case, you use one page sequence each for the table of contents, the body text, and the index.</p><p>Each page sequence contains up to three kinds of child elements, in this order:</p><ol>	<li>An optional <code>fo:title</code> element containing inline content that can be used as the title of the document. This would normally be placed in the title bar of the browser window like the <code>TITLE</code> element in HTML.</li>	<li>Zero or more <code>fo:static-content</code> elements containing text to be placed on every page.</li>	<li>One <code>fo:flow</code> element containing data to be placed on each page in turn.</li></ol><p>The main difference between a <code>fo:flow</code> and a <code>fo:static-content</code> is that text from the flow isn&#146;t placed on more than one page, whereas the static content is. For example, the words you&#146;re reading now are flow content that only appear on this page, whereas the part and chapter titles at the top of the page are static content that is repeated from page to page throughout the chapter.</p><p>The <code>fo:flow</code> element contains, in order, the elements to be placed on the page. As each page fills with elements from the flow, a new page is created with the next master page in the page sequence master for the elements that remain in the flow. With a simple page master, the same page will be instantiated repeatedly, as many times as necessary to hold all the content.</p><p>The <code>fo:static-content</code> element contains information to be placed on each page. For example, it may place the title of a book in the header of each page. Static content can be adjusted depending on the master page. For instance, the part title may be placed on left-hand pages, and the chapter title on right-hand pages. The <code>fo:static-content</code> element can also be used for items such as page numbers that have to be calculated from page to page. In other words, what&#146;s static is not the text, but the calculation that produces the text.</p><h4>Flows</h4><p>The <code>fo:flow</code> object holds the actual content that will be placed on the instances of the master pages. This content is composed of a sequence of <code>fo:block</code>, <code>fo:block-container</code>, <code>fo:table-and-caption</code>, <code>fo:table</code>, and <code>fo:list-block</code> elements. This section sticks to basic <code>fo:block</code> elements, which are roughly equivalent HTML&#146;s <code>DIV</code> elements. Later in this chapter, you learn more block-level elements that a flow can contain.</p><p>For example, here is a basic flow containing the names of several atoms, each in its own block:</p><pre>&lt;fo:flow flow-name="xsl-region-body"&gt;  &lt;fo:block&gt;Actinium&lt;/fo:block&gt;  &lt;fo:block&gt;Aluminum&lt;/fo:block&gt;  &lt;fo:block&gt;Americium&lt;/fo:block&gt;&lt;/fo:flow&gt;</pre><p>The <code>flow-name</code> attribute of the <code>fo:flow</code>, here with the value <code>xsl-region-body</code>, specifies which of the five regions of the page this flow&#146;s content will be placed in. The allowed values are as follows:</p><ul>	<li><p><code>xsl-region-body</p></code></li>	<li><p><code>xsl-region-before</p></code></li>	<li><p><code>xsl-region-after</p></code></li>	<li><p><code>xsl-region-start</p></code></li>	<li><p><code>xsl-region-end</code></p></li></ul><p>For example, a <code>flow</code> for the header has a <code>flow-name</code> value of <code>xsl-region-before</code>. A flow for the body has the <code>flow-nam</code>e of <code>xsl-region-body</code>. There can&#146;t be two flows with the same name in the same page sequence. Thus, each <code>fo:page-sequence</code> can contain at most five <code>fo:flow</code> children, one for each of the five regions on the page.</p><p>You can now put together a complete style sheet that lays out the entire periodic table. Listing 16-3 demonstrates this with an XSLT style sheet that converts the periodic table into XSL formatting objects. The flow grabs all the atoms and places each one in its own block. A simple page master named <code>only</code> defines an A4-sized master page in landscape mode with half-inch margins on each side.</p><font face="Arial"><p>Listing 16-3: A Basic Style Sheet for the Periodic Table</p></font><pre>&lt;?xml version="1.0"?&gt;&lt;xsl:stylesheet version="1.0"  xmlns:xsl="http://www.w3.org/1999/XSL/Transform"  xmlns:fo="http://www.w3.org/1999/XSL/Format"&gt;  &lt;xsl:template match="/"&gt;    &lt;fo:root xmlns:fo="http://www.w3.org/1999/XSL/Format"&gt;      &lt;fo:layout-master-set&gt;        &lt;fo:simple-page-master master-name="A4"           page-width="297mm"  page-height="210mm"           margin-top="0.5in"  margin-bottom="0.5in"           margin-left="0.5in" margin-right="0.5in"&gt;          &lt;fo:region-body/&gt;        &lt;/fo:simple-page-master&gt;      &lt;/fo:layout-master-set&gt;      &lt;fo:page-sequence master-reference="A4"&gt;        &lt;fo:flow flow-name="xsl-region-body"&gt;          &lt;xsl:apply-templates select="//ATOM"/&gt;        &lt;/fo:flow&gt;      &lt;/fo:page-sequence&gt;    &lt;/fo:root&gt;  &lt;/xsl:template&gt;  &lt;xsl:template match="ATOM"&gt;    &lt;fo:block&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/fo:block&gt;  &lt;/xsl:template&gt;&lt;/xsl:stylesheet&gt;</pre><p>Figure 16-4 shows the resulting document after Listing 16-3 has been run through an XSLT processor to produce an XSL-FO document, and that document has been run through FOP to produce a PDF file.</p><p><img src="picture5.jpg"></p><p>Figure 16-4: The rendered form of Listing 16-3</p><h4>Static content</h4><p>Whereas each piece of the content of a <code>fo:flow</code> element appears on one page, each piece of the content of a <code>fo:static-content</code> element appears on every page. For example, if this book were laid out in XSL-FO, both the header at the top of the page and the footer at the bottom of the page would have been produced by <code>fo:static-content</code> elements. You do not have to use <code>fo:static-content</code> elements, but if you do use them, they must appear before all the <code>fo:flow</code> elements in the page sequence.</p><code><p>fo:static-content</code> elements have the same attributes and contents as a <code>fo:flow</code>. However, because a <code>fo:static-content</code> cannot break its contents across multiple pages if necessary, it generally has less content than a <code>fo:flow</code>. For example, Listing 16-4 uses a <code>fo:static-content</code> to place the words &quot;The Periodic Table&quot; in the header of each page.</p><font face="Arial"><p>Listing 16-4: Using fo:static-content to Generate a Header</p></font><pre>&lt;?xml version="1.0"?&gt;&lt;xsl:stylesheet version="1.0"  xmlns:xsl="http://www.w3.org/1999/XSL/Transform"  xmlns:fo="http://www.w3.org/1999/XSL/Format"&gt;  &lt;xsl:template match="/"&gt;    &lt;fo:root xmlns:fo="http://www.w3.org/1999/XSL/Format"&gt;      &lt;fo:layout-master-set&gt;        &lt;fo:simple-page-master master-name="A4"           page-width="297mm"   page-height="210mm"           margin-top="0.5in"  margin-bottom="0.5in"           margin-left="0.5in" margin-right="0.5in"&gt;          &lt;fo:region-before extent="1.0in"/&gt;          &lt;fo:region-body margin-top="1.0in"/&gt;        &lt;/fo:simple-page-master&gt;      &lt;/fo:layout-master-set&gt;      &lt;fo:page-sequence master-reference="A4"&gt;        &lt;fo:static-content flow-name="xsl-region-before"&gt;          &lt;fo:block&gt;The Periodic Table&lt;/fo:block&gt;        &lt;/fo:static-content&gt;        &lt;fo:flow flow-name="xsl-region-body"&gt;          &lt;xsl:apply-templates select="//ATOM"/&gt;        &lt;/fo:flow&gt;      &lt;/fo:page-sequence&gt;    &lt;/fo:root&gt;  &lt;/xsl:template&gt;  &lt;xsl:template match="ATOM"&gt;    &lt;fo:block&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/fo:block&gt;  &lt;/xsl:template&gt;&lt;/xsl:stylesheet&gt;</pre><p>Figure 16-5 shows the last page of the PDF file ultimately produced from Listing 16-4. The same text, &quot;The Periodic Table,&quot; appears on all four pages of the document.</p><p><img src="picture7.jpg"></p><p>Figure 16-5: Static content in the header</p><h4>Page numbering</h4><p>The <code>fo:page-sequence</code> element has eight optional attributes that define page numbers for the sequence:</p><ul><li><code>initial-page-number</li><li>force-page-count</li><li>format</li><li>letter-value</li><li>country</li><li>language</li><li>grouping-separator</li><li>grouping-size</li></code></ul><p>The <code>initial-page-number</code> attribute gives the number of the first page in this sequence. The most likely value for this attribute is 1, but it could be a larger number if the previous pages are in a different <code>fo:page-sequence</code> or even a different document. It can also be set to one of these three key words:</p><ul><li><code>auto</code>&#150;1 unless pages from a preceding <code>fo:page-sequence</code> have pushed that up. This is the default.</li><li><code>auto-odd</code>&#150;Same as <code>auto</code>, but add 1 if that value is an even number; that is, start on an odd page.</li><li><code>auto-even</code>&#150;Same as <code>auto</code>, but add 1 if that value is an odd number; that is, start on an even page.</li></ul><p>The <code>force-page-count</code> attribute mandates that the document have an even or odd number of pages or ends on an even or odd page. This is sometimes necessary for printed books. The <code>force-page-count</code> attribute can have one of these six keyword values:</p><ul><li><code>auto</code>&#150;Make the last page an odd page if the <code>initial-page-number</code> of the next <code>fo:page-sequence</code> is even. Make the last page an even page if the initial-page-number of the next page-sequence is odd. If there is no next <code>fo:page-sequence</code> or if the next <code>fo:page-sequence</code> does not specify an <code>initial-page-number</code>, let the last page fall where it may.</li><li><code>even</code>&#150;Require an even number of pages, inserting an extra blank page if necessary to make it so.</li><li><code>odd</code>&#150;Require an odd number of pages, inserting an extra blank page if necessary to make it so.</li><li><code>end-on-even</code>&#150;Require the last page to have an even page number, inserting an extra blank page if necessary to make it so.</li><li><code>end-on-odd</code>&#150;Require the last page to have an odd page number, inserting an extra blank page if necessary to make it so.</li><li><code>no-force</code>&#150;Do not require either an even or odd number of pages.</li></ul><p>The <code>country</code> attribute should be set to an RFC 1766 country code  (<code>http://www.ietf.org/rfc/rfc1766.txt</code>). The <code>language</code> attribute should be set to an RFC 1766 language code. For example, you would use <code>en</code> to indicate English and <code>us</code> to indicate the United States.</p><dir><b><font face="Arial" size=1 color="#000080"><p>Cross-Reference</p></b></font><p>These are essentially the same as the legal values for <code>xml:lang</code> that were discussed in Chapter 6, except that the country code and language codes are placed in two separate attributes rather than in one attribute.</p></dir><p>The remaining four attributes have exactly the same syntax and meaning as when used as attributes of the <code>xsl:number</code> element from XSLT, so I won&#146;t repeat that discussion here.</p><dir><b><font face="Arial" size=1 color="#000080"><p>Cross-Reference</p></b></font><p>The <code>xsl:number</code> element and the <code>format</code>, <code>letter-value</code>, <code>grouping-separator</code>, and <code>grouping-size</code> attributes are discussed in the Number to String Conversion&quot; section in Chapter 15.</p></dir><p>The <code>fo:page-number</code> formatting object is an empty inline element that inserts the number of the current page. The formatter is responsible for determining what that number is. This element can have a variety of formatting attributes common to inline elements such as <code>font-family</code> and <code>text-decoration</code>. For example, Listing 16-5 uses <code>fo:static-content</code> and <code>fo:page-number</code> to put the page number at the bottom of every page:</p><font face="Arial"><p>Listing 16-5: Using fo:page-number to Place the Page Number in the Footer</p></font><pre>&lt;?xml version="1.0"?&gt;&lt;xsl:stylesheet version="1.0"  xmlns:xsl="http://www.w3.org/1999/XSL/Transform"  xmlns:fo="http://www.w3.org/1999/XSL/Format"&gt;  &lt;xsl:template match="/"&gt;    &lt;fo:root xmlns:fo="http://www.w3.org/1999/XSL/Format"&gt;      &lt;fo:layout-master-set&gt;        &lt;fo:simple-page-master master-name="A4"           page-width="297mm"  page-height="210mm"           margin-top="0.5in"  margin-bottom="0.5in"           margin-left="0.5in" margin-right="0.5in"&gt;          &lt;fo:region-before extent="1.0in"/&gt;          &lt;fo:region-body margin-top="1.0in"                          margin-bottom="1.0in"/&gt;          &lt;fo:region-after  extent="1.0in"/&gt;        &lt;/fo:simple-page-master&gt;      &lt;/fo:layout-master-set&gt;      &lt;fo:page-sequence master-reference="A4"        initial-page-number="1"&gt;        &lt;fo:static-content flow-name="xsl-region-before"&gt;          &lt;fo:block&gt;The Periodic Table&lt;/fo:block&gt;        &lt;/fo:static-content&gt;        &lt;fo:static-content flow-name="xsl-region-after"&gt;          &lt;fo:block&gt;p. &lt;fo:page-number/&gt;&lt;/fo:block&gt;        &lt;/fo:static-content&gt;        &lt;fo:flow flow-name="xsl-region-body"&gt;          &lt;xsl:apply-templates select="//ATOM"/&gt;        &lt;/fo:flow&gt;      &lt;/fo:page-sequence&gt;    &lt;/fo:root&gt;  &lt;/xsl:template&gt;  &lt;xsl:template match="ATOM"&gt;    &lt;fo:block&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/fo:block&gt;  &lt;/xsl:template&gt;&lt;/xsl:stylesheet&gt;</pre><p>Figure 16-6 shows the second page of the PDF file generated from Listing 16-5. The page number appears at the bottom of this and every other page in the document.</p><p><img src="picture9.jpg"></p><p>Figure 16-6: Automatically generated page numbers in the footer</p><h3>Page sequence masters</h3><p>Each page the formatter creates is associated with a master page from the <code>fo:layout-master-set</code> that defines how the page will look. The <code>master-reference</code> attribute of the <code>fo:page-sequence</code> element determines which master page this is. Listings 16-3 through 16-5 used a single <code>fo:simple-master-page</code> named <code>A4</code> to fill this role, but it is not uncommon to have more than one master page. For example, you could use one master page for the first page of each chapter, a different one for all the subsequent left-hand pages, and a third for all the subsequent right-hand pages. In this case, the master pages might be grouped as part of a <code>fo:page-sequence-master</code> instead.</p><p>The <code>fo:page-sequence-master</code> element is a child of the <code>fo:layout-master-set</code> that lists the order in which particular master pages will be instantiated using one or more of these three child elements:</p><ul><li><code>fo:single-page-master-reference</li><li>fo:repeatable-page-master-reference</li><li>fo:repeatable-page-master-alternatives</li></code></ul><p>The <code>fo:single-page-master-reference</code> and <code>fo:repeatable-page-master-reference </code>elements each have a <code>master-reference</code> attribute that specifies which <code>fo:simple-master-page</code> their pages are based on. The <code>fo:repeatable-page-master-alternatives</code> has child <code>fo:conditional-page-master-reference</code> elements that are instantiated based on various conditions.  Each of these child  <code>fo:conditional-page-master-reference</code> elements has a <code>master-reference</code> attribute that specifies which <code>fo:simple-master-page</code> to use if its condition is satisfied.</p><h4>fo:single-page-master-reference</h4><p>The simplest page master element is <code>fo:single-page-master-reference</code> whose <code>master-reference</code> attribute identifies one master page to be instantiated. For example, this <code>fo:layout-master-set</code> contains a <code>fo:page-sequence-master</code> element named <code>contents</code> that says that all text should be placed on a single instance of the master page named <code>A4</code>:</p><pre>&lt;fo:layout-master-set&gt;  &lt;fo:simple-page-master master-name="A4"      page-width="297mm"  page-height="210mm"      margin-top="0.5in"  margin-bottom="0.5in"      margin-left="0.5in" margin-right="0.5in"&gt;    &lt;fo:region-body/&gt;  &lt;/fo:simple-page-master&gt;  &lt;fo:page-sequence-master master-name="contents"&gt;    &lt;fo:single-page-master-reference master-reference="A4"/&gt;  &lt;/fo:page-sequence-master&gt;&lt;/fo:layout-master-set&gt;</pre><p>This page sequence master only allows the creation of a single page. Technically, it&#146;s an error if there&#146;s more content than can fit on this one page. However, in practice, most formatters simply repeat the last page used until they have enough pages to hold all the content.</p><p>Now consider this page sequence master:</p><pre>&lt;fo:page-sequence-master master-name="contents"&gt;  &lt;fo:single-page-master-reference master-name="A4"/&gt;  &lt;fo:single-page-master-reference master-name="A4"/&gt;&lt;/fo:page-sequence-master&gt;</pre><p>This provides for up to two pages, each based on the master page named <code>A4</code>. If the first page fills up, a second is created. If that page fills up, the formatter may throw an error, or it may create extra pages.</p><p>The same technique can be used to apply different master pages. For example, this sequence specification bases the first page on the master page named <code>front</code> and the second on the master page named <code>back</code>:</p><pre>&lt;fo:page-sequence-master master-name="contents"&gt;  &lt;fo:single-page-master-reference master-reference="front"/&gt;  &lt;fo:single-page-master-reference master-reference="back"/&gt;&lt;/fo:page-sequence-master&gt;</pre><p>The first page the formatter creates will be based on the master page named front. The second page created will be based on the master page named back. If the second page fills up, the formatter may throw an error; or it may create extra pages based on back, the last master page instantiated.</p><h4>fo:repeatable-page-master-reference</h4><p>Of course, you usually don&#146;t know in advance exactly how many pages there will be. The <code>fo:repeatable-page-master-reference</code> element specifies that as many pages as necessary will be used to hold the content, all based on a single master page. The <code>master-reference</code> attribute identifies which master page will be repeated. For example, this page sequence master will use as many copies of the master page named <code>A4</code> as necessary to hold all the content:</p><pre>&lt;fo:page-sequence-master master-name="contents"&gt;  &lt;fo:repeatable-page-master-reference master-reference="A4"/&gt;&lt;/fo:page-sequence-master&gt;</pre><p>Alternately, you can set the <code>maximum-repeats</code> attribute of the <code>fo:repeatable-page-master-reference</code> element to limit the number of pages that will be created. For example, this <code>fo:page-sequence-master</code> generates at most 10 pages per document:</p><pre>&lt;fo:page-sequence-master master-name="contents"&gt;  &lt;fo:repeatable-page-master-reference master-reference="A4"                                       maximum-repeats="10"/&gt;&lt;/fo:page-sequence-master&gt;</pre><p>This also lets you do things like using one master for the first 2 pages, another for the next 3 pages, and a third master for the next 10 pages.</p><h4>fo:repeatable-page-master-alternatives</h4><p>The <code>fo:repeatable-page-master-alternatives</code> element specifies different master pages for the first page, even pages, odd pages, blank pages, last even page, and last odd page. This is more designed for a chapter of a printed book where the first and last pages, as well the even and odd pages, traditionally have different margins, headers, and footers.</p><p>Because a <code>fo:repeatable-page-master-alternatives</code> element needs to refer to more than one master page, it can&#146;t use a <code>master-reference</code> attribute such as <code>fo:single-page-master-reference</code> and <code>fo:repeatable-page-master-reference</code>. Instead, it has <code>fo:conditional-page-master-reference</code> child elements. Each of these has a <code>master-reference</code> attribute that identifies the master page to instantiate given that condition. The conditions themselves are determined by three attributes:</p><ul><li><code>page-position</code>&#150;This attribute can be set to <code>first</code>, <code>last</code>, <code>rest</code>, or <code>any</code> to identify it as applying only to the first page, last page, any page except the first, or any page, respectively.</li><li><code>odd-or-even</code>&#150;This attribute can be set to <code>odd</code>, <code>even</code>, or <code>any</code> to identify it as applying only to odd pages, only to even pages, or to all pages, respectively.</li><li><code>blank-or-not-blank</code>&#150;This attribute can be set to <code>blank</code>, <code>not-blank</code>, or <code>any</code> to identify it as applying only to blank pages, only to pages that contain content, or to all pages, respectively.</li></ul><p>For example, this page sequence master says that the first page should be based on the master page named <code>letter_first</code>, but that all subsequent pages should use the master page named <code>letter</code>:</p><pre>&lt;fo:page-sequence-master master-name="contents"&gt;  &lt;fo:repeatable-page-master-alternatives&gt;    &lt;fo:conditional-page-master-reference       page-position="first" master-reference="letter_first"/&gt;    &lt;fo:conditional-page-master-reference       page-position="rest"  master-reference="letter"/&gt;  &lt;/fo:repeatable-page-master-alternatives&gt;&lt;/fo:page-sequence-master master-reference="contents"&gt;</pre><p>If the content overflows the first page, the remainder will be placed on a second page. If it overflows the second page, a third page will be created. As many pages as needed to hold all the content will be constructed.</p><h2>Content</h2><p>The content (as opposed to markup) of an XSL-FO document is mostly text. Non-XML content such as GIF and JPEG images can be included in a fashion similar to the <code>IMG</code> element of HTML. Other forms of XML content, such as MathML and SVG, can be embedded directly inside the XSL-FO document. This content is stored in several kinds of elements, including the following:</p><ul><li>Block-level formatting objects</li><li>Inline formatting objects</li><li>Table formatting objects</li><li>Out-of-line formatting objects</li></ul><p>All of these different kinds of elements are descendants of either a <code>fo:flow</code> or a <code>fo:static-content</code> element. They are never placed directly on page masters or page sequences.</p><h3>Block-level formatting objects</h3><p>A block-level formatting object is drawn as a rectangular area separated by a line break and possibly extra white space from any content that precedes or follows it. Blocks may contain other blocks, in which case the contained blocks are also separated from the containing block by a line break and perhaps extra white space. Block-level formatting objects include the following:</p><ul><li><code>fo:block</li><li>fo:block-container</li><li>fo:table-and-caption</li><li>fo:table</li><li>fo:list-block</li></code></ul><p>The <code>fo:block</code> element is the XSL-FO equivalent of <code>display: block</code> in CSS or <code>DIV</code> in HTML. Blocks may be contained in <code>fo:flow</code> elements, other <code>fo:block</code> elements, and <code>fo:static-content</code> elements. <code>fo:block</code> elements may contain other <code>fo:block</code> elements, other block-level elements such as <code>fo:table</code> and <code>fo:list-block</code>, and inline elements such as <code>fo:inline</code> and <code>fo:page-number</code>. Block-level elements may also contain raw text, as in this example:</p><pre>&lt;fo:block&gt;The Periodic Table, Page &lt;fo:page-number/&gt;&lt;/fo:block&gt;</pre><p>The block-level elements generally have attributes for both area properties and text-formatting properties. The text-formatting properties are inherited by any child elements of the block unless overridden.</p><dir><b><font face="Arial" size=1 color="#000080"><p>Caution</p></b></font><p>As of version 0.20.5, FOP does not support <code>fo:block-container</code> or <code>fo:table-and-caption</code>.</p></dir><h3>Inline formatting objects</h3><p>An inline formatting object is also drawn as a rectangular area that may contain text or other inline areas. However, inline areas are most commonly arranged in lines running from left to right. When a line fills up, a new line is started below the previous one. The exact order in which inline elements are placed depends on the writing mode. For example, when working in Hebrew or Arabic, inline elements are first placed on the right and fill to the left. Inline formatting objects include the following:</p><ul><li><code>fo:bidi-override</li><li>fo:character</li><li>fo:external-graphic</li><li>fo:initial-property-set</li><li>fo:instream-foreign-object</li><li>fo:inline</li><li>fo:inline-container</li><li>fo:leader</li><li>fo:page-number</li><li>fo:page-number-citation</li></code></ul><dir><b><font face="Arial" size=1 color="#000080"><p>Caution</p></b></font><p>As of version 0.20.5, FOP does not support <code>fo:bidi-override</code>, <code>fo:initial-property-set</code>, or <code>fo:inline-container</code>.</p></dir><h3>Table formatting objects</h3><p>The table formatting objects are the XSL-FO equivalents of CSS2 table properties. However, tables do work somewhat more naturally in XSL-FO than in CSS. For the most part, an individual table is a block-level object, while the parts of the table aren&#146;t really either inline or block level. However, an entire table can be turned into an inline object by wrapping it in a <code>fo:inline-container</code>. There are nine XSL table-formatting objects:</p><ul><li><code>fo:table-and-caption</li><li>fo:table</li><li>fo:table-caption</li><li>fo:table-column</li><li>fo:table-header</li><li>fo:table-footer</li><li>fo:table-body</li><li>fo:table-row</li><li>fo:table-cell</li></code></ul><p>The root of a table is either a <code>fo:table</code> or a <code>fo:table-and-caption</code> that contains a <code>fo:table</code> and a <code>fo:caption</code>. The <code>fo:table</code> contains a <code>fo:table-header</code>, <code>fo:table-body</code>, and <code>fo:table-footer</code>. The table body contains <code>fo:table-row</code> elements that are divided up into <code>fo:table-cell</code> elements.</p><dir><b><font face="Arial" size=1 color="#000080"><p>Caution</p></b></font><p>FOP 0.20.5 has limited support for the table formatting objects, and none at all for <code>fo:table-and-caption</code> and <code>fo:table-caption</code>.</p></dir><h3>Out-of-line formatting objects</h3><p>There are three &quot;out-of-line&quot; formatting objects:</p><ul><li><code>fo:float</li><li>fo:footnote</li><li>fo:footnote-body</li></code></ul><p>Out-of-line formatting objects &quot;borrow&quot; space from existing inline or block objects. On the page, they do not necessarily appear between the same elements that they appeared between in the input-formatting object XML tree.</p><dir><b><font face="Arial" size=1 color="#000080"><p>Caution</p></b></font><p>FOP 0.20.5 does not support <code>fo:float</code>.</p></dir><h2>Leaders and Rules</h2><p>A <i>rule</i> is a block-level horizontal line inserted into text similar to the line below the chapter title on the first page of this chapter. The <code>HR</code> element in HTML produces a rule. A <i>leader</i> is a line that extends from the right side of left-aligned text in the middle of a line to the left side of some right-aligned text on the same line. It&#146;s most commonly made up of dots, although other characters can be used. Leaders are commonly seen in menus and tables of contents. In fact, if you flip back to the table of contents at the beginning of this book, you&#146;ll see leaders between chapter and section titles and the page numbers.</p><p>In XSL-FO both leaders and rules are produced by the <code>fo:leader</code> element. This is an inline element that represents a leader, although it can easily serve as a rule by placing it inside a <code>fo:block</code>.</p><p>Six attributes describe the appearance of a leader:</p><ul><li><code>leader-alignment</code>&#150;This can be set to <code>reference-area</code> or <code>page</code> to indicate that the start edge of the leader should be aligned with the start edge of the named item. It can also be set to <code>none</code> or <code>inherit</code>.</li><li><code>leader-length</code>&#150;The length of the leader, such as <code>12pc</code> or <code>5in</code>.</li><li><code>leader-pattern</code>&#150;This can be set to <code>space</code>, <code>rule</code>, <code>dots</code>, <code>use-content</code>, or <code>inherit</code>. The <code>use-content</code> value means that the leader characters should be read from the content of the <code>fo:leader</code> element.</li><li><code>leader-pattern-width</code>&#150;This property can be set to a specific length such as <code>2mm</code> or to <code>use-font-metrics</code>, which indicates that the leader should simply be as big as it would naturally be. This is not the length of the entire leader (which is set by <code>leader-length</code>); it is the length of each repeating pattern in the leader. If necessary, white space will be added to stretch each pattern out to the requested length.</li><li><code>rule-style</code>&#150;This property has the same values as the CSS <code>border-style</code> properties; that is, <code>none</code>, <code>dotted</code>, <code>dashed</code>, <code>solid</code>, <code>double</code>, <code>groove</code>, <code>ridge</code>, and <code>inherit</code>.</li><li><code>rule-thickness</code>&#150;This property is the thickness (width) of the rule; 1 point by default.</li></ul><p>In addition, a number of other common properties apply to leaders. For instance, you can use the <code>font-family</code> property to change the font in which a leader is drawn or the <code>color</code> property to change the color in which a leader is drawn. For example, this is a green horizontal line that&#146;s 7.5 inches long and 2 points thick:</p><pre>&lt;fo:block&gt;  &lt;fo:leader leader-length="7.5in" leader-pattern="rule"             rule-thickness="2pt" color="green"/&gt;&lt;/fo:block&gt;</pre><p>Listing 16-6 uses <code>fo:leader</code> to place a rule at the top of each page footer.</p><font face="Arial"><p>Listing 16-6: Using fo:leader to Separate the Footer from the Body with a Horizontal Line</p></font><pre>&lt;?xml version="1.0"?&gt;&lt;xsl:stylesheet version="1.0"  xmlns:xsl="http://www.w3.org/1999/XSL/Transform"  xmlns:fo="http://www.w3.org/1999/XSL/Format"&gt;  &lt;xsl:template match="/"&gt;    &lt;fo:root xmlns:fo="http://www.w3.org/1999/XSL/Format"&gt;      &lt;fo:layout-master-set&gt;        &lt;fo:simple-page-master master-name="A4"           page-width="297mm"  page-height="210mm"           margin-top="0.5in"  margin-bottom="0.5in"           margin-left="0.5in" margin-right="0.5in"&gt;          &lt;fo:region-before extent="1.0in"/&gt;          &lt;fo:region-body margin-top="1.0in"                          margin-bottom="1.0in"/&gt;          &lt;fo:region-after  extent="1.0in"/&gt;        &lt;/fo:simple-page-master&gt;      &lt;/fo:layout-master-set&gt;      &lt;fo:page-sequence master-reference="A4"        initial-page-number="1"&gt;        &lt;fo:static-content flow-name="xsl-region-before"&gt;          &lt;fo:block&gt;The Periodic Table&lt;/fo:block&gt;        &lt;/fo:static-content&gt;        &lt;fo:static-content flow-name="xsl-region-after"&gt;          &lt;fo:block&gt;&lt;fo:leader leader-pattern="rule"                               leader-length="18cm" /&gt;          &lt;/fo:block&gt;          &lt;fo:block&gt;p. &lt;fo:page-number/&gt;&lt;/fo:block&gt;        &lt;/fo:static-content&gt;        &lt;fo:flow flow-name="xsl-region-body"&gt;          &lt;xsl:apply-templates select="//ATOM"/&gt;        &lt;/fo:flow&gt;      &lt;/fo:page-sequence&gt;    &lt;/fo:root&gt;  &lt;/xsl:template&gt;  &lt;xsl:template match="ATOM"&gt;    &lt;fo:block&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/fo:block&gt;  &lt;/xsl:template&gt;&lt;/xsl:stylesheet&gt;</pre><p>Figure 16-7 shows the third page of the PDF file generated from Listing 16-6. The rule appears at the bottom of this and every other page in the document.</p><p><img src="picture11.jpg"></p><p>Figure 16-7: Automatically generated rules in the footer</p><h2>Graphics</h2><p>XSL-FO provides two elements for embedding pictures in a rendered document. The <code>fo:external-graphic</code> element inserts a non-XML graphic, such as a JPEG image. The <code>fo:instream-foreign-object</code> element inserts an XML document that is not an XSL-FO document, such as an SVG picture or a MathML equation.</p><h3>fo:external-graphic</h3><p>The <code>fo:external-graphic</code> element provides the equivalent of an HTML <code>IMG</code> element. That is, it loads an image, probably in a non-XML format, from a URL. <code>fo:external-graphic</code> is always an empty element with no children. The <code>src</code> attribute contains a URI identifying the location of the image to be embedded. For example, consider this standard HTML <code>IMG</code> element:</p><pre>&lt;IMG SRC="cup.gif"&gt;</pre><p>The <code>fo:external-graphic</code> equivalent looks like this:</p><pre>&lt;fo:external-graphic src="cup.gif"/&gt;</pre><p>Of course, you can use an absolute URL if you like:</p><pre>&lt;fo:external-graphic      src="http://www.cafeconleche.org/images/cup.gif"/&gt;</pre><p>Just as with web browsers and HTML, there&#146;s no guarantee that any particular formatting engine recognizes and supports any particular graphic format. Currently, FOP supports GIF, JPEG, and SVG  images. EPS images can be printed but not displayed on-screen. PNG and TIFF are supported if you have Sun&#146;s Java Advanced Imaging API library installed. More formats may be added in the future.</p><code><p>fo:external-graphic</code> is an inline element. You can make it a block-level picture simply by wrapping it in a <code>fo:block</code> element, like this:</p><pre>&lt;fo:block&gt;&lt;fo:external-graphic src="cup.gif"/&gt;&lt;/fo:block&gt;</pre><p>Listing 16-7 shows a style sheet that loads the image at <code>http://cafeconleche.org/images/atom.jpg</code> and puts it in the header of all the pages. In this case, the URI of the image is hard-coded in the style sheet. In general, however, it would be read from the input document.</p><font face="Arial"><p>Listing 16-7: An XSL Style Sheet That References an External Graphic</p></font><pre>&lt;?xml version="1.0"?&gt;&lt;xsl:stylesheet version="1.0"  xmlns:xsl="http://www.w3.org/1999/XSL/Transform"  xmlns:fo="http://www.w3.org/1999/XSL/Format"&gt;  &lt;xsl:template match="/"&gt;    &lt;fo:root xmlns:fo="http://www.w3.org/1999/XSL/Format"&gt;      &lt;fo:layout-master-set&gt;        &lt;fo:simple-page-master master-name="A4"           page-width="297mm"  page-height="210mm"           margin-top="0.5in"  margin-bottom="0.5in"           margin-left="0.5in" margin-right="0.5in"&gt;          &lt;fo:region-before extent="1.0in"/&gt;          &lt;fo:region-body margin-top="1.0in"                          margin-bottom="1.0in"/&gt;          &lt;fo:region-after  extent="1.0in"/&gt;        &lt;/fo:simple-page-master&gt;      &lt;/fo:layout-master-set&gt;      &lt;fo:page-sequence master-reference="A4"        initial-page-number="1"&gt;        &lt;fo:static-content flow-name="xsl-region-before"&gt;          &lt;fo:block&gt;            &lt;fo:external-graphic              src="http://cafeconleche.org/images/atom.jpg"             /&gt;            The Periodic Table          &lt;/fo:block&gt;        &lt;/fo:static-content&gt;        &lt;fo:static-content flow-name="xsl-region-after"&gt;          &lt;fo:block&gt;            &lt;fo:leader leader-pattern="rule"                       leader-length="18cm"/&gt;          &lt;/fo:block&gt;          &lt;fo:block&gt;p. &lt;fo:page-number/&gt;&lt;/fo:block&gt;        &lt;/fo:static-content&gt;        &lt;fo:flow flow-name="xsl-region-body"&gt;          &lt;xsl:apply-templates select="//ATOM"/&gt;        &lt;/fo:flow&gt;      &lt;/fo:page-sequence&gt;    &lt;/fo:root&gt;  &lt;/xsl:template&gt;  &lt;xsl:template match="ATOM"&gt;    &lt;fo:block&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/fo:block&gt;  &lt;/xsl:template&gt;&lt;/xsl:stylesheet&gt;</pre><p>Figure 16-8 shows the first page of the PDF file generated from Listing 16-7. The picture appears at the top of this and every other page in the document.</p><p><img src="picture13.jpg"></p><p>Figure 16-8: Inserting an external graphic in the header</p><h3>fo:instream-foreign-object</h3><p>The <code>fo:instream-foreign-object</code> element inserts a graphic that is described in XML and that is included directly in the XSL-FO document. For example, a <code>fo:instream-foreign-object</code> element might contain an SVG picture. The formatter would render the picture in the finished document. Listing 16-8 is an XSL-FO document that places the pink triangle SVG example from Chapter 2 on the header of each page:</p><font face="Arial"><p>Listing 16-8: An XSL Style Sheet That Contains an Instream SVG Picture</p></font><pre>&lt;?xml version="1.0"?&gt;&lt;xsl:stylesheet version="1.0"  xmlns:xsl="http://www.w3.org/1999/XSL/Transform"  xmlns:fo="http://www.w3.org/1999/XSL/Format"&gt;  &lt;xsl:template match="/"&gt;    &lt;fo:root xmlns:fo="http://www.w3.org/1999/XSL/Format"&gt;      &lt;fo:layout-master-set&gt;        &lt;fo:simple-page-master master-name="A4"           page-width="297mm"  page-height="210mm"           margin-top="0.5in"  margin-bottom="0.5in"           margin-left="0.5in" margin-right="0.5in"&gt;          &lt;fo:region-before extent="1.0in"/&gt;          &lt;fo:region-body   margin-top="1.0in"/&gt;        &lt;/fo:simple-page-master&gt;      &lt;/fo:layout-master-set&gt;      &lt;fo:page-sequence master-reference="A4"        initial-page-number="1"&gt;        &lt;fo:static-content flow-name="xsl-region-before"&gt;          &lt;fo:block&gt; The Periodic Table            &lt;fo:instream-foreign-object&gt;              &lt;svg xmlns="http://www.w3.org/2000/svg"                 width="1.5cm" height="1cm"&gt;       &lt;polygon style="fill:#FFCCCC" points="0,31 18,0 36,31"/&gt;              &lt;/svg&gt;            &lt;/fo:instream-foreign-object&gt;          &lt;/fo:block&gt;        &lt;/fo:static-content&gt;        &lt;fo:flow flow-name="xsl-region-body"&gt;          &lt;xsl:apply-templates select="//ATOM"/&gt;        &lt;/fo:flow&gt;      &lt;/fo:page-sequence&gt;    &lt;/fo:root&gt;  &lt;/xsl:template&gt;  &lt;xsl:template match="ATOM"&gt;    &lt;fo:block&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/fo:block&gt;  &lt;/xsl:template&gt;&lt;/xsl:stylesheet&gt;</pre><p>Figure 16-9 shows the first page of the PDF file generated from Listing 16-8. The triangle appears at the top of this and every other page in the document.</p><p><img src="picture15.jpg"></p><p>Figure 16-9: Inserting an instream graphic in the header</p><dir><b><font face="Arial" size=1 color="#000080"><p>Cross-Reference</p></b></font><p>SVG is discussed in depth in Chapter 24.</p></dir><p>Not all formatters support all possible XML graphics formats. For example, FOP does not support MathML at all, and only supports a subset of SVG. Still, this is a useful technique, especially when you want XSLT to generate pictures at runtime. For instance, you could write an XSLT style sheet that produced nicely formatted annual reports, including all the charts and graphics, simply by transforming some of the input document into XSL-FO and other parts of the input document into SVG.</p><h3>Graphic properties</h3><code><p>fo:external-graphic</code> and <code>fo:instream-foreign-object</code> share a number of properties designed to scale, position, crop, align, and otherwise adjust the appearance of the image on the page.</p><h4>Content type</h4><p>The <code>content-type</code> attribute specifies the type of the graphic. You can give this as a MIME media type, such as image/jpg or image/svg+xml, by prefixing the actual type with <code>content-type:</code>. For example, to specify that the <code>fo:external-graphic</code> element refers to a GIF image, you would write it as follows:</p><pre>&lt;fo:external-graphic content-type="content-type:image/gif"                     src="cup.gif" /&gt;</pre>                     <p>This can also be given in terms of a namespace prefix by using a value in the form <code>namespace-prefix:<i>prefix</i></code>. For example, to specify that the <code>fo:instream-foreign-object</code> includes an SVG picture, you write it as follows:</p><pre>&lt;fo:instream-foreign-object   xmlns:svg="http://www.w3.org/2000/svg"   content-type="namespace-prefix:svg"&gt;</pre><p>The namespace prefix does not have to be declared on the <code>fo:instream-foreign-object</code> element. It simply needs to be declared somewhere in the ancestors of the element.</p><h4>Size</h4><p>The <code>height</code> and <code>width</code> attributes specify the vertical and horizontal size of the rectangle set aside on the page for the image. Either or both of these can be set to the keyword <code>auto</code>, rather than to an absolute length, to indicate that the size of the image itself should be used.</p><p>The <code>content-height</code> and <code>content-width</code> attributes specify the vertical and horizontal size of the image itself. If either or both of these is not the same as <code>height</code> and <code>width</code>, respectively, the image has to be scaled.</p><h4>Scaling</h4><p>The <code>scaling</code> attribute can be set to either <code>uniform</code> or <code>non-uniform</code>. Uniform scaling maintains the height-to-width ratio of the image as it&#146;s scaled. This is the default. Nonuniform scaling may scale the height and width differently, so that the image is distorted.</p><p>You can also choose the algorithm by which scaling occurs by using the <code>scaling-method</code> attribute. This can be set to <code>auto</code>, <code>integer-pixels</code>, or <code>resample-any-method</code>. Integer scaling maintains an integral ratio between original and scaled images, such as 2:1 or 3:1, but not 1.5:1 or 3:2. In most cases, integer-scaled images are smaller than images scaled by <code>resample-any-method</code>, but won&#146;t require dithering. The value <code>auto</code> lets the formatter decide what to do.</p><p>In addition, you can set a variety of common properties for inline elements. These include the common accessibility, aural, background, border, padding, and margin properties. Because graphics shouldn't be split across multiple pages, they don&#146;t support the usual break properties, but they do support <code>keep-with-next</code> and <code>keep-with-previous</code>.</p><h2>Links</h2><p>The <code>fo:basic-link</code> element encodes HTML-style hyperlinks in XSL-FO documents. This is an inline formatting object that the user can click on to move to a different document, or to a different place in the same document. This doesn&#146;t offer much for print, but it might be useful when and if web browsers support XSL-FO directly. The link behavior is controlled by these eight attributes:</p><ul><li><code>external-destination</code></li><li>internal-destination</li><li>indicate-destination</li><li>show-destination</li><li>destination-placement-offset</li><li>target-presentation-context</li><li>target-processing-context</li><li>target-stylesheet</li></ul><p>A link to a remote document target specifies the URI through the value of the <code>external-destination</code> attribute. The browser should replace the current document with the document at this URI when the reader activates the link. In most GUI environments, the user activates the link by clicking on its contents. For example:</p><pre>&lt;fo:block&gt; Be sure to visit the   &lt;fo:basic-link     external-destination="http://www.cafeconleche.org/"&gt;      Cafe con Leche web site!   &lt;/fo:basic-link&gt;&lt;/fo:block&gt;</pre><p>You can also link to another node in the same document by using the <code>internal-destination</code> attribute. The value of this attribute is not a URI, but rather the ID of the element you&#146;re linking to. You can often use XSLT&#146;s <code>generate-id()</code> function to produce both the IDs on the output elements and the links to those elements inside the XSL-FO output. You should not specify both an internal and external destination for one link.</p><p>The three other destination attributes affect the appearance and behavior of the link. The <code>indicate-destination</code> attribute has a boolean value (<code>true</code> or <code>false</code>; <code>false</code> by default) that specifies whether, when the linked item is loaded, it should somehow be distinguished from nonlinked parts of the same document. For example, if you follow a link to one <code>ATOM</code> element in a table of 100 atoms, the specific atom you were connecting to might be in boldface, while the other atoms are in normal type. The exact details are system-dependent.</p><p>The <code>show-destination</code> attribute has two possible values: <code>replace</code> (the default) and <code>new</code>. With a value of <code>replace</code>, when a link is followed, the target document replaces the existing document in the same window. With a value of <code>new</code>, when the user activates a link, the browser opens a new window in which to display the target document.</p><p>When a browser follows an HTML link into the middle of a document, generally the specific linked element is positioned at the tip-top of the window. The <code>destination-placement-offset</code> attribute specifies how far down the browser should scroll the linked element in the window. It&#146;s given as a length, such as <code>3in</code> or <code>156px</code>.</p><p>The three target properties describe how the document at the other end of the link will be displayed. The <code>target-presentation-context</code> attribute contains a URI that generally indicates some subset of the external destination that should actually be presented to the user. For example, an XPointer could be used here to say that although an entire book is loaded, only the seventh chapter will be shown.</p><dir><b><font face="Arial" size=1 color="#000080"><p>Cross-Reference</p></b></font><p>XPointer is discussed in depth in Chapter 18.</p></dir><p>The <code>target-processing-context</code> attribute contains the base URI used to resolve relative URIs in the external destination. Without a <code>target-processing-context</code> attribute, relative URIs are relative to the current document.</p><p>Finally, the <code>target-stylesheet</code> attribute contains a URI that points to a style sheet that should be used when the targeted document is rendered. This overrides any style sheet that the targeted document itself specifies, whether through an <code>xml-stylesheet</code> processing instruction, a <code>LINK</code> element in HTML, or an HTTP header.</p><p>In addition, the link may have the usual accessibility, margin, background, border, padding, and aural properties.</p><h2>Lists</h2><p>The <code>fo:list-block</code> formatting object element describes a block-level list element. (There are no inline lists.) A list may or may not be bulleted, numbered, indented, or otherwise formatted. Each <code>fo:list-block</code> element contains either a series of <code>fo:list-item</code> elements or <code>fo:list-item-label</code> <code>fo:list-item-body</code> pairs. (It cannot contain both.) A <code>fo:list-item</code> must contain a <code>fo:list-item-label</code> and a <code>fo:list-item-body</code>. The <code>fo:list-item-label</code> contains the bullet, number, or other label for the list item as a block-level element. The <code>fo:list-item-body</code> contains block-level elements holding the list item&#146;s content. To summarize, a <code>fo:list-block</code> contains <code>fo:list-item</code> elements. Each <code>fo:list-item</code> contains a <code>fo:list-item-label</code> and <code>fo:list-item-body</code>. However, the <code>fo:list-item</code> elements can be omitted. For example:</p><pre>&lt;fo:list-block&gt;  &lt;fo:list-item&gt;     &lt;fo:list-item-label&gt;&lt;fo:block&gt;*&lt;/fo:block&gt;     &lt;/fo:list-item-label&gt;    &lt;fo:list-item-body&gt;      &lt;fo:block&gt;Actinium&lt;/fo:block&gt;    &lt;/fo:list-item-body&gt;  &lt;/fo:list-item&gt;  &lt;fo:list-item&gt;     &lt;fo:list-item-label&gt;&lt;fo:block&gt;*&lt;/fo:block&gt;     &lt;/fo:list-item-label&gt;    &lt;fo:list-item-body&gt;      &lt;fo:block&gt;Aluminum&lt;/fo:block&gt;    &lt;/fo:list-item-body&gt;  &lt;/fo:list-item&gt;&lt;/fo:list-block&gt;</pre><p>Or, with the <code>fo:list-item</code> tags removed:</p><pre>&lt;fo:list-block&gt;   &lt;fo:list-item-label&gt;     &lt;fo:block&gt;*&lt;/fo:block&gt;   &lt;/fo:list-item-label&gt;   &lt;fo:list-item-body&gt;     &lt;fo:block&gt;Actinium&lt;/fo:block&gt;   &lt;/fo:list-item-body&gt;   &lt;fo:list-item-label&gt;     &lt;fo:block&gt;*&lt;/fo:block&gt;   &lt;/fo:list-item-label&gt;   &lt;fo:list-item-body&gt;    &lt;fo:block&gt;Aluminum&lt;/fo:block&gt;   &lt;/fo:list-item-body&gt;&lt;/fo:list-block&gt;</pre><p>The <code>fo:list-block</code> element has two special attributes that control list formatting:</p><ul><li><code>provisional-label-separation</code>&#150;The distance between the list item label and the list item body, given as a triplet of <i>maximum;minimum;optimum</i>, such as <code>2mm;0.5mm;1mm</li><li>provisional-distance-between-starts</code>&#150;The distance between the start edge of the list item label and the start edge of the list item body</li></ul><code><p>fo:list-block</code> also has the usual accessibility, aural, border, padding, background, margin, and keeps and breaks properties. The <code>fo:list-item</code> element has the standard block-level properties for backgrounds, position, aural rendering, borders, padding, margins, and line and page breaking. The <code>fo:list-item-label</code> and <code>fo:list-item-body</code> elements only have the accessibility properties: <code>id</code> and <code>keep-together</code>. The rest of their formatting is controlled either by the parent elements (<code>fo:list-item</code> and <code>fo:list-item-block</code>) or the child elements they contain.</p><p>Listing 16-9 formats the periodic table as a list in which the atomic numbers are the list labels and the names of the elements are the list bodies. Figure 16-10 shows the second page of output produced by this style sheet.</p><font face="Arial"><p>Listing 16-9: An XSL Style Sheet That Formats the Periodic Table as a List</p></font><pre>&lt;?xml version="1.0"?&gt;&lt;xsl:stylesheet version="1.0"  xmlns:xsl="http://www.w3.org/1999/XSL/Transform"  xmlns:fo="http://www.w3.org/1999/XSL/Format"&gt;  &lt;xsl:template match="/"&gt;    &lt;fo:root xmlns:fo="http://www.w3.org/1999/XSL/Format"&gt;      &lt;fo:layout-master-set&gt;        &lt;fo:simple-page-master master-name="A4"           page-width="297mm"  page-height="210mm"           margin-top="0.5in"  margin-bottom="0.5in"           margin-left="0.5in" margin-right="0.5in"&gt;          &lt;fo:region-body/&gt;        &lt;/fo:simple-page-master&gt;      &lt;/fo:layout-master-set&gt;      &lt;fo:page-sequence master-reference="A4"&gt;        &lt;fo:flow flow-name="xsl-region-body"&gt;          &lt;fo:list-block&gt;            &lt;xsl:apply-templates select="//ATOM"&gt;              &lt;xsl:sort data-type="number"                        select="ATOMIC_NUMBER"/&gt;            &lt;/xsl:apply-templates&gt;          &lt;/fo:list-block&gt;        &lt;/fo:flow&gt;      &lt;/fo:page-sequence&gt;    &lt;/fo:root&gt;  &lt;/xsl:template&gt;  &lt;xsl:template match="ATOM"&gt;    &lt;fo:list-item&gt;      &lt;fo:list-item-label&gt;&lt;fo:block&gt;         &lt;xsl:value-of select="ATOMIC_NUMBER"/&gt;      &lt;/fo:block&gt;&lt;/fo:list-item-label&gt;      &lt;fo:list-item-body&gt;&lt;fo:block&gt;        &lt;xsl:value-of select="NAME"/&gt;      &lt;/fo:block&gt;&lt;/fo:list-item-body&gt;    &lt;/fo:list-item&gt;  &lt;/xsl:template&gt;&lt;/xsl:stylesheet&gt;</pre><p><img src="picture17.jpg"></p><p>Figure 16-10: The periodic table formatted as a list</p><p>In HTML, a list item implies a certain level of indenting. However, as you can see in Figure 16-10, no such indenting is implied by any of the XSL-FO list elements. If you want list items to be indented, you can use the <code>start-indent</code> and <code>end-indent</code> attributes on the <code>fo:list-item-label</code> and <code>fo:list-item-body</code> elements. Each of these is set to a length. However, because the list item body normally starts on the same line as the list item label, its start indent is often given by the special XSL-FO <code>body-start()</code> function. This returns the combined length of the <code>start-indent</code> and the <code>provisional-distance-between-starts</code>, as in the following example:</p><pre>&lt;xsl:template match="ATOM"&gt;  &lt;fo:list-item&gt;    &lt;fo:list-item-label start-indent="1.0cm"                         end-indent="1.0cm"&gt;      &lt;fo:block&gt;        &lt;xsl:value-of select="ATOMIC_NUMBER"/&gt;       &lt;/fo:block&gt;    &lt;/fo:list-item-label&gt;    &lt;fo:list-item-body start-indent="body-start()"&gt;      &lt;fo:block&gt;        &lt;xsl:value-of select="NAME"/&gt;      &lt;/fo:block&gt;    &lt;/fo:list-item-body&gt;  &lt;/fo:list-item&gt;&lt;/xsl:template&gt;</pre><h2>Tables</h2><p>The fundamental table element in XSL is <code>fo:table-and-caption</code>. This is a block-level object that contains a <code>fo:table</code> and a <code>fo:caption</code>. If your table doesn&#146;t need a caption, you can just use a raw <code>fo:table</code> instead. The XSL-FO table model is quite close to HTML&#146;s table model. Table 16-1 shows the mapping between HTML 4.0 table elements and XSL formatting objects.</p><font face="Arial"><p align="CENTER">Table 16-1</p><b><p align="CENTER">HTML Tables versus XSL Formatting Object Tables</p></b></font><table border cellspacing=1 bordercolor="#000000" width=235><tr><td width="46%" valign="TOP"><b><i><font face="Arial" size=1><p>HTML Element</b></i></font></td><td width="54%" valign="TOP"><b><i><font face="Arial" size=1><p>XSL FO Element</b></i></font></td></tr><tr><td width="46%" valign="TOP"><code><font face="Arial" size=1><p>TABLE</code></font></td><td width="54%" valign="TOP"><code><font face="Arial" size=1><p>fo:table-and-caption</code></font></td></tr><tr><td width="46%" valign="TOP"><font face="Arial" size=1><p>no equivalent</font></td><td width="54%" valign="TOP"><code><font face="Arial" size=1><p>fo:table</code></font></td></tr><tr><td width="46%" valign="TOP"><code><font face="Arial" size=1><p>CAPTION</code></font></td><td width="54%" valign="TOP"><code><font face="Arial" size=1><p>fo:table-caption</code></font></td></tr><tr><td width="46%" valign="TOP"><code><font face="Arial" size=1><p>COL</code></font></td><td width="54%" valign="TOP"><code><font face="Arial" size=1><p>fo:table-column</code></font></td></tr><tr><td width="46%" valign="TOP"><code><font face="Arial" size=1><p>COLGROUP</code></font></td><td width="54%" valign="TOP"><font face="Arial" size=1><p>no equivalent</font></td></tr><tr><td width="46%" valign="TOP"><code><font face="Arial" size=1><p>THEAD</code></font></td><td width="54%" valign="TOP"><code><font face="Arial" size=1><p>fo:table-header</code></font></td></tr><tr><td width="46%" valign="TOP"><code><font face="Arial" size=1><p>TBODY</code></font></td><td width="54%" valign="TOP"><code><font face="Arial" size=1><p>fo:table-body</code></font></td></tr><tr><td width="46%" valign="TOP"><code><font face="Arial" size=1><p>TFOOT</code></font></td><td width="54%" valign="TOP"><code><font face="Arial" size=1><p>fo:table-footer</code></font></td></tr><tr><td width="46%" valign="TOP"><code><font face="Arial" size=1><p>TD</code></font></td><td width="54%" valign="TOP"><code><font face="Arial" size=1><p>fo:table-cell</code></font></td></tr><tr><td width="46%" valign="TOP"><code><font face="Helvetica" size=1><p>TR</code></font></td><td width="54%" valign="TOP"><code><font face="Helvetica" size=1><p>fo:table-row</code></font></td></tr></table><p>Each <code>fo:table-and-caption</code> contains an optional <code>fo:table-caption</code> element and one <code>fo:table</code> element. The caption can contain any block-level elements you care to place in the caption. By default, captions are placed before the table, but this can be adjusted by setting the <code>caption-side</code> property of the <code>table-and-caption</code> element to one of these eight values:</p><ul><li><code>before</li><li>after</li><li>start</li><li>end</li><li>top</li><li>bottom</li><li>left</li><li>right</li></code></ul><p>For example, here&#146;s a table with a caption on the bottom:</p><pre>&lt;fo:table-and-caption caption-side="bottom"&gt;  &lt;fo:table-caption&gt;    &lt;fo:block font-weight="bold"              font-family="Helvetica, Arial, sans"              font-size="12pt"&gt;      Table 16-1: HTML Tables vs. XSL Formatting Object Tables    &lt;/fo:block&gt;  &lt;/fo:table-caption&gt;  &lt;fo:table&gt;    &lt;!-- table contents go here --&gt;  &lt;/fo:table&gt;&lt;/fo:table-and-caption&gt;</pre><p>The <code>fo:table</code> element contains <code>fo:table-column</code> elements, an optional <code>fo:table-header</code>, an optional <code>fo:table-footer</code>, and one or more <code>fo:table-body</code> elements. The <code>fo:table-body</code> is divided into <code>fo:table-row</code> elements. Each <code>fo:table-row</code> is divided into <code>fo:table-cell</code> elements. The <code>fo:table-header</code> and <code>fo:table-footer</code> can either be divided into <code>fo:table-cell</code> or <code>fo:table-row</code> elements. For example, here&#146;s a simple table that includes the first three rows of Table 16-1:</p><pre>&lt;fo:table&gt;  &lt;fo:table-header&gt;    &lt;fo:table-cell&gt;      &lt;fo:block font-family="Helvetica, Arial, sans"                font-size="11pt" font-weight="bold"&gt;        HTML Element      &lt;/fo:block&gt;    &lt;/fo:table-cell&gt;    &lt;fo:table-cell&gt;      &lt;fo:block font-family="Helvetica, Arial, sans"                font-size="11pt" font-weight="bold"&gt;        XSL FO Element      &lt;/fo:block&gt;    &lt;/fo:table-cell&gt;  &lt;/fo:table-header&gt;  &lt;fo:table-body&gt;    &lt;fo:table-row&gt;      &lt;fo:table-cell&gt;        &lt;fo:block font-family="Courier, monospace"&gt;          TABLE        &lt;/fo:block&gt;      &lt;/fo:table-cell&gt;      &lt;fo:table-cell&gt;        &lt;fo:block font-family="Courier, monospace"&gt;          fo:table-and-caption        &lt;/fo:block&gt;      &lt;/fo:table-cell&gt;    &lt;/fo:table-row&gt;    &lt;fo:table-row&gt;      &lt;fo:table-cell&gt;        &lt;fo:block&gt;no equivalent&lt;/fo:block&gt;      &lt;/fo:table-cell&gt;      &lt;fo:table-cell&gt;        &lt;fo:block font-family="Courier, monospace"&gt;          fo:table        &lt;/fo:block&gt;      &lt;/fo:table-cell&gt;    &lt;/fo:table-row&gt;  &lt;/fo:table-body&gt;&lt;/fo:table&gt;</pre><p>You can make table cells span multiple rows and columns by setting the <code>number-columns-spanned</code> and/or <code>number-rows-spanned</code> attributes to an integer giving the number of rows or columns to span. The optional <code>column-number</code> attribute can change which column the spanning begins in. The default is the current column.</p><p>You can draw borders around table parts using the normal border properties. The <code>empty-cells</code> attribute has the value <code>show</code> or <code>hide</code>; <code>show</code> if borders are to be drawn around cells with no content, <code>hide</code> if not. The default is <code>show</code>.</p><p>When a long table extends across multiple pages, sometimes the header and footer are repeated on each page. You can alter this behavior with the <code>table-omit-header-at-break</code> and <code>table-omit-footer-at-break</code> attributes of the <code>fo:table</code> element. The value <code>false</code> indicates that the header or footer is to be repeated from page to page. The value <code>true</code> indicates that it is not. The default is <code>false</code>.</p><p>The optional <code>fo:table-column</code> element is an empty element that specifies properties for all cells in a particular column. The cells it applies to are identified by the <code>column-number</code> attribute or by the position of the <code>fo:table-column</code> element itself. <code>fo:table-column</code> does not actually contain any cells. A <code>fo:table-column</code> can apply properties to more than one consecutive column by setting the <code>number-columns-spanned</code> property to an integer greater than one. The most common property to set in a <code>fo:table-column</code> is <code>column-width</code> (a signed length), but the standard border, padding, and background properties (discussed shortly and mostly the same as in CSS) can also be set.</p><dir><b><font face="Arial" size=1 color="#000080"><p>Caution</p></b></font><p>FOP 0.20.5 has limited table support. In particular, it does not support <code>fo:table-caption</code> or <code>fo:table-and-caption</code>. Furthermore, FOP requires you to explicitly specify the column widths using a <code>fo:table-column</code> element. You can't let it choose suitable widths as you might let a web browser do.</p></dir><p>For example, Listing 16-10 lays out all the properties of the elements in a table. Figure 16-11 shows the first page of output produced by this style sheet.</p><font face="Arial"><p>Listing 16-10: An XSL Style Sheet That Formats the Elements as a Table</p></font><pre>&lt;?xml version="1.0"?&gt;&lt;xsl:stylesheet version="1.0"  xmlns:xsl="http://www.w3.org/1999/XSL/Transform"  xmlns:fo="http://www.w3.org/1999/XSL/Format"&gt;  &lt;xsl:template match="/"&gt;    &lt;fo:root xmlns:fo="http://www.w3.org/1999/XSL/Format"&gt;      &lt;fo:layout-master-set&gt;        &lt;fo:simple-page-master master-name="A4"           page-width="297mm"  page-height="210mm"           margin-top="0.5in"  margin-bottom="0.5in"           margin-left="0.5in" margin-right="0.5in"&gt;          &lt;fo:region-body/&gt;        &lt;/fo:simple-page-master&gt;      &lt;/fo:layout-master-set&gt;      &lt;fo:page-sequence master-reference="A4"&gt;        &lt;fo:flow flow-name="xsl-region-body"&gt;          &lt;fo:table&gt;            &lt;fo:table-column column-width="30mm"/&gt;            &lt;fo:table-column column-width="12mm"/&gt;            &lt;fo:table-column column-width="12mm"/&gt;            &lt;fo:table-column column-width="25mm"/&gt;            &lt;fo:table-column column-width="27mm"/&gt;            &lt;fo:table-column column-width="18mm"/&gt;            &lt;fo:table-column column-width="49mm"/&gt;            &lt;fo:table-column column-width="16mm"/&gt;            &lt;fo:table-column column-width="16mm"/&gt;            &lt;fo:table-column column-width="16mm"/&gt;            &lt;fo:table-column column-width="21mm"/&gt;            &lt;fo:table-column column-width="21mm"/&gt;            &lt;fo:table-column column-width="21mm"/&gt;            &lt;fo:table-body&gt;              &lt;xsl:apply-templates select="//ATOM"&gt;                &lt;xsl:sort data-type="number"                  select="ATOMIC_NUMBER"/&gt;              &lt;/xsl:apply-templates&gt;            &lt;/fo:table-body&gt;          &lt;/fo:table&gt;        &lt;/fo:flow&gt;      &lt;/fo:page-sequence&gt;    &lt;/fo:root&gt;  &lt;/xsl:template&gt;  &lt;xsl:template match="ATOM"&gt;    &lt;fo:table-row&gt;      &lt;fo:table-cell&gt;        &lt;fo:block&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/fo:block&gt;      &lt;/fo:table-cell&gt;      &lt;fo:table-cell&gt;        &lt;fo:block&gt;&lt;xsl:value-of select="SYMBOL"/&gt;&lt;/fo:block&gt;      &lt;/fo:table-cell&gt;      &lt;fo:table-cell&gt;        &lt;fo:block&gt;          &lt;xsl:value-of select="ATOMIC_NUMBER"/&gt;        &lt;/fo:block&gt;      &lt;/fo:table-cell&gt;      &lt;fo:table-cell&gt;        &lt;fo:block&gt;          &lt;xsl:value-of select="ATOMIC_WEIGHT"/&gt;        &lt;/fo:block&gt;      &lt;/fo:table-cell&gt;      &lt;fo:table-cell&gt;        &lt;fo:block&gt;          &lt;xsl:value-of select="OXIDATION_STATES"/&gt;        &lt;/fo:block&gt;      &lt;/fo:table-cell&gt;      &lt;fo:table-cell&gt;        &lt;fo:block&gt;&lt;xsl:value-of select="DENSITY"/&gt;&lt;/fo:block&gt;      &lt;/fo:table-cell&gt;      &lt;fo:table-cell&gt;        &lt;fo:block&gt;          &lt;xsl:value-of select="ELECTRON_CONFIGURATION"/&gt;        &lt;/fo:block&gt;      &lt;/fo:table-cell&gt;      &lt;fo:table-cell&gt;        &lt;fo:block&gt;          &lt;xsl:value-of select="ELECTRONEGATIVITY"/&gt;        &lt;/fo:block&gt;      &lt;/fo:table-cell&gt;      &lt;fo:table-cell&gt;        &lt;fo:block&gt;          &lt;xsl:value-of select="ATOMIC_RADIUS"/&gt;        &lt;/fo:block&gt;      &lt;/fo:table-cell&gt;      &lt;fo:table-cell&gt;        &lt;fo:block&gt;          &lt;xsl:value-of select="ATOMIC_VOLUME"/&gt;        &lt;/fo:block&gt;      &lt;/fo:table-cell&gt;      &lt;fo:table-cell&gt;        &lt;fo:block&gt;          &lt;xsl:value-of select="SPECIFIC_HEAT_CAPACITY"/&gt;        &lt;/fo:block&gt;      &lt;/fo:table-cell&gt;      &lt;fo:table-cell&gt;        &lt;fo:block&gt;          &lt;xsl:value-of select="SPECIFIC_HEAT_CAPACITY"/&gt;        &lt;/fo:block&gt;      &lt;/fo:table-cell&gt;      &lt;fo:table-cell&gt;        &lt;fo:block&gt;          &lt;xsl:value-of select="THERMAL_CONDUCTIVITY"/&gt;        &lt;/fo:block&gt;      &lt;/fo:table-cell&gt;    &lt;/fo:table-row&gt;  &lt;/xsl:template&gt;&lt;/xsl:stylesheet&gt;</pre><p><img src="picture19.jpg"></p><p>Figure 16-11: The periodic table formatted as a table</p><h2>Inlines</h2><p>The <code>fo:inline</code> element has no particular effect on the layout of the page. Rather, it&#146;s an element on which you can hang formatting attributes, such as <code>font-style</code> or <code>color</code>, for application to the inline&#146;s contents. The <code>fo:inline</code> formatting object is a container that groups inline objects together. It cannot contain block-level elements. For example, you can use <code>fo:inline</code> elements to add style to various parts of the footer, like this:</p><pre>&lt;fo:static-content flow-name="xsl-region-after"&gt;  &lt;fo:block font-weight="bold" font-size="10pt"            font-family="Arial, Helvetica, sans"&gt;     &lt;fo:inline font-style="italic" text-align="start"&gt;       The XML Bible     &lt;/fo:inline&gt;     &lt;fo:inline text-align="centered"&gt;       Page &lt;fo:page-number/&gt;     &lt;/fo:inline&gt;     &lt;fo:inline text-align="right"&gt;       Chapter 19: XSL Formatting Objects     &lt;/fo:inline&gt;  &lt;/fo:block&gt;&lt;/fo:static-content&gt;</pre><h2>Footnotes</h2><p>The <code>fo:footnote</code> element creates a footnote. The author places the <code>fo:footnote</code> element in the flow exactly where the footnote reference such as <sup>1</sup> or <sup>*</sup> will occur. The <code>fo:footnote</code> element contains both the reference text and a <code>fo:footnote-body</code> block-level element containing the text of the footnote. However, only the footnote reference is inserted inline. The formatter places the note text in the after region (generally the footer) of the page.</p><p>For example, this footnote uses an asterisk as a footnote marker and refers to &quot;<i>JavaBeans</i>, Elliotte Rusty Harold (IDG Books, Foster City, 1998), p. 147&quot;. Standard properties such as <code>font-size</code> and <code>vertical-align</code> are used to format both the note marker and the text in the customary fashion.</p><pre>&lt;fo:footnote&gt;  &lt;fo:inline font-size="smaller" vertical-align="super"&gt;*  &lt;/fo:inline&gt;  &lt;fo:footnote-body font-size="smaller"&gt;    &lt;fo:inline font-size="smaller" vertical-align="super"&gt;       *    &lt;/fo:inline&gt;    &lt;fo:inline font-style="italic"&gt;JavaBeans&lt;/fo:inline&gt;,      Elliotte Rusty Harold      (IDG Books, Foster City, 1998), p. 147  &lt;/fo:footnote-body&gt;&lt;/fo:footnote&gt;</pre><dir><b><font face="Arial" size=1 color="#000080"><p>Tip</p></b></font><p>XSL-FO doesn&#146;t provide any means of automatically numbering and citing footnotes, but this can be done by judicious use of <code>xsl:number</code> in the transformation style sheet. XSL Transformations make end notes easy as well.</p></dir><h2>Floats</h2><p>A <code>fo:float</code> produces a floating box anchored to the top of the region where it occurs. A <code>fo:float</code> is most commonly used for graphics, charts, tables, or other out-of-line content that needs to appear somewhere on the page, although precisely where it appears is not particularly important. For example, this <code>fo:block</code> includes a floating graphic with a caption:</p><pre>&lt;fo:block&gt;  Although PDF files are themselves ASCII text,  this isn't a book about PostScript, so there's  nothing to be gained by showing you the exact  output of the above command. If you're curious,  open the PDF file in any text editor.  Instead, Figure 16-1  &lt;fo:float float="before"&gt;    &lt;fo:external-graphic src="549863 fg1601.tif"                         height="485px" width="623px" /&gt;    &lt;fo:block font-family="Helvetica, sans"&gt;      &lt;fo:inline font-weight="bold"&gt;        Figure 16-1:      &lt;/fo:inline&gt;      The PDF file displayed in Netscape Navigator    &lt;/fo:block&gt;  &lt;/fo:float&gt;  shows the rendered file displayed in  Netscape Navigator using the Acrobat plug-in.&lt;/fo:block&gt;</pre><p>The formatter tries to place the graphic somewhere on the same page where the content surrounding the <code>fo:float</code> appears. However, it may not always be able to find room on that page. If it can&#146;t, it moves the object to a subsequent page. </p><p>The value of the <code>float</code> attribute indicates on which side of the page the <code>fo:float</code> floats. It can be set to <code>before</code>, <code>start</code>, <code>end</code>, <code>left</code>, <code>right</code>, <code>none</code>, or <code>inherit</code>.</p><p>The <code>clear</code> attribute can be set on elements near the floating object to indicate whether they'll flow around the side of the float or whether they&#146;ll move below the float. It can have the following values:</p><ul><li><code>start</code>&#150;The start edge of the object must not be adjacent to a floating object.</li><li><code>end</code>&#150;The end edge of the object must not be adjacent to a floating object.</li><li><code>left</code>&#150;The left edge of the object must not be adjacent to a floating object.</li><li><code>right</code>&#150;The right edge of the object must not be adjacent to a floating object.</li><li><code>both</code>&#150;Neither the left nor the right edge of the object may be adjacent to a floating object.</li><li><code>none</li></code></ul><p>Within those limits, the formatter is free to place the graphic anywhere on the page.</p><dir><b><font face="Arial" size=1 color="#000080"><p>Caution</p></b></font><p>FOP 0.20.5 does not support the <code>fo:float</code> formatting object.</p></dir><h2>Formatting Properties</h2><p>By themselves, formatting objects say relatively little about how content is formatted. They merely put content in abstract boxes, which are placed in particular parts of a page. Attributes on the various formatting objects determine how the content in those boxes is styled.</p><p>As already mentioned, there are more than 200 different formatting properties. Not all properties can be attached to all elements. For instance, there isn&#146;t much point to specifying the <code>font-style</code> of a <code>fo:external-graphic</code>. Most properties, however, can be applied to more than one kind of formatting object element. (The few that can&#146;t, such as <code>src</code> and <code>provisional-label-separation</code>, were discussed previously with the formatting objects they apply to.) When a property is common to multiple formatting objects, it shares the same syntax and meaning across the objects. For example, you use identical code to format a <code>fo:title</code> in 14-point Times bold as you do to format a <code>fo:block</code> in 14-point Times bold.</p><p>Many of the XSL-FO properties are similar to CSS properties. The value of a CSS <code>font-family</code> property is the same as the value of an XSL-FO <code>font-family</code> attribute. If you&#146;ve read about CSS in Chapters 12 through 14, you&#146;re already more than half finished learning XSL-FO properties.</p><h3>The id property</h3><p>You can apply the <code>id</code> property to any element. The value of this property must be an XML name that&#146;s unique within the style sheet and within the output formatting object document. The last requirement is a little tricky because it&#146;s possible that one template rule in the style sheet may generate several hundred elements in the output document. XSLT&#146;s <code>generate-id()</code> function can be useful here.</p><h3>The language property</h3><p>The <code>language</code> property specifies the language of the content contained in either a <code>fo:block</code> or a <code>fo:character</code> element. Generally, the value of this property is an ISO 639 language code such as <code>en</code> (English) or <code>la</code> (Latin). It may also be the keyword <code>none</code> or <code>use-document</code>. The latter means to simply use the language of the input as specified by the <code>xml:lang</code> attribute. For example, consider the first verse of Caesar&#146;s <i>Gallic Wars</i>:</p><pre>&lt;fo:block id="verse1.1.1" language="la"&gt;  Gallia est omnis divisa in partes tres,  quarum unam incolunt Belgae, aliam Aquitani,  tertiam qui ipsorum lingua Celtae, nostra Galli appellantur&lt;/fo:block&gt;</pre><p>Although the <code>language</code> property has no direct effect on formatting, it may have an indirect effect if the formatter selects layout algorithms depending on the language. For example, the formatter should use different default writing modes for Arabic and English text. This carries over into determination of the start and end regions and the inline and block progression directions. It can also be used to choose the proper hyphenation dictionary.</p><h3>Paragraph properties</h3><p>Paragraph properties are styles that normally are thought of as applying to an entire block of text in a traditional word processor, although perhaps <i>block-level text properties</i> is a more appropriate name here. For example, indentation is a paragraph property, because you can indent a paragraph, but you can&#146;t indent a single word.</p><h4>Break properties</h4><p>The break properties specify where page breaks are and are not allowed. There are five loosely related break properties:</p><ul><li><code>keep-with-next</li><li>keep-with-previous</li><li>keep-together</li><li>break-before</li><li>break-after</li></code></ul><p>The <code>keep-with-next</code> property determines how much effort the formatter will expend to keep this formatting object on the same page as the following formatting object. The <code>keep-with-previous</code> property determines how much effort the formatter will expend to keep this formatting object on the same page as the preceding formatting object. And the <code>keep-together</code> property determines how much effort the formatter will expend to keep the contents of this formatting object on one page. These are not hard-and-fast rules because it&#146;s always possible that a formatting object is just too big for one page. Each of these properties can be set to an integer giving the strength of the effort to keep the objects on the same page (larger integers are stronger) or to the keywords <code>always</code> or <code>auto</code>. <code>always</code> means maximum effort; <code>auto</code> means let the breaks fall where they may.</p><p>By contrast, the <code>break-before</code> property and <code>break-after</code> properties mandate some kind of break. What exactly is broken is determined by the value of the property. This can be one of these five values:</p><ul><li><code>column</code>&#150;Break the current column and move to the next column.</li><li><code>page</code>&#150;Break the current page and move to the next page.</li><li><code>even-page</code>&#150;Break the current page and move to the next even-numbered page, inserting a blank page if the current page is itself an even-numbered page.</li><li><code>odd-page</code>&#150;Break the current page and move to the next odd-numbered page, inserting a blank page if the current page is itself an odd-numbered page.</li><li><code>auto</code>&#150;Let the formatter decide where to break; the default.</li></ul><p>For example, this template rule ensures that each <code>ATOM</code> of sufficiently small size is printed on a page of its own:</p><pre>&lt;xsl:template match="ATOM"&gt;  &lt;fo:block break-before="page" break-after="page"&gt;    &lt;xsl:apply-templates/&gt;  &lt;/fo:block&gt;&lt;/xsl:template&gt;</pre><p>Finally, the <code>inhibit-line-breaks</code> property is a boolean that can be set to <code>true</code> to indicate that not even a line break is allowed, much less a page break.</p><p>XSL-FO also defines three shorthand page-break properties: <code>page-break-after</code>, <code>page-break-before</code>, and <code>page-break-inside</code>. These are not absolutely necessary because their effects can be achieved by appropriate combinations of the keep and break properties. For example, to specify a page break after an element, you&#146;d set <code>break-before</code> to <code>page</code> and <code>keep-with-previous</code> to <code>auto</code>.</p><h4>Hyphenation properties</h4><p>The hyphenation properties determine where hyphenation is allowed and how it should be used. These properties apply only to soft or &quot;optional&quot; hyphens, such as those sometimes used to break long words at the end of a line. They do not apply to hard hyphens, such as the ones in the word <i>mother-in-law</i>, although hard hyphens may affect where soft hyphens are allowed. There are six hyphenation properties:</p><ul><li><code>hyphenate</code>&#150;Automatic hyphenation is allowed only if this property has the value <code>true</code>.</li><li><code>hyphenation-character</code>&#150;The Unicode character used to hyphenate words, such as - in English.</li><li><code>hyphenation-keep</code>&#150;One of the four keywords (<code>column</code>, <code>none</code>, <code>page</code>, <code>inherit</code>) that specify where and whether hyphenation is allowed. The default is not to hyphenate.</li><li><code>hyphenation-ladder-count</code>&#150;A nonnegative integer that specifies the maximum number of hyphenated lines that may appear in a row.</li><li><code>hyphenation-push-character-count</code>&#150;A nonnegative integer that specifies the minimum number of characters that must follow an automatically inserted hyphen. (Short syllables look bad in isolation.)</li><li><code>hyphenation-remain-character-count</code>&#150;A nonnegative integer specifying the minimum number of characters that must precede an automatically inserted hyphen.</li></ul><p>For example:</p><pre>&lt;fo:block hyphenate="true"          hyphenation-character="-"          hyphenation-keep="none"          hyphenation-ladder-count="2"          hyphenation-push-character-count="4"          hyphenation-remain-character-count="4" &gt;  some content...&lt;/fo:block&gt;</pre><p>XSL-FO does not specify a word-breaking algorithm to determine where a soft hyphen may be applied. Even when these properties allow hyphenation, it&#146;s still completely up to the formatter to figure out how to hyphenate individual words. Indeed, basic formatters may not attempt to hyphenate words at all.</p><h4>Indent properties</h4><p>The indent properties specify how far lines are indented from the edge of the text. There are four of these:</p><ul>	<li><p><code>start-indent</code></p></li>	<li><p><code>end-indent</code></p></li>	<li><p><code>text-indent</code></p></li>	<li><p><code>last-line-end-indent</code></p></li></ul><p>The <code>start-indent</code> property offsets all lines from the start edge (left edge in English). The <code>end-indent</code> property offsets all lines from the end edge (right edge in English). The <code>text-indent</code> property offsets only the first line from the start edge. The <code>last-line-end-indent</code> property offsets only the last line from the start edge. Values are given as a signed length. For example, a standard paragraph with a half-inch, first-line indent might be formatted this way:</p><pre>&lt;fo:block text-indent="0.5in"&gt;  The first line of this paragraph is indented&lt;/fo:block&gt;</pre><p>A block quote with a 1-inch indent on all lines on both sides is formatted like this:</p><pre>&lt;fo:block start-indent="1.0in" end-indent="1.0in"&gt;  This text is offset one inch from both edges.&lt;/fo:block&gt;</pre><p>Because the <code>text-indent</code> is added to the <code>start-indent</code> to get the total indentation of the first line, using a positive value for <code>start-indent</code> and a negative value for <code>text-indent</code> creates hanging indents. For example, all lines except the first in this paragraph are indented by 1 inch. The first line is only indented half an inch:</p><pre>&lt;fo:block text-indent="-0.5in" start-indent="1.0in"&gt;  This paragraph uses a hanging indent.&lt;/fo:block&gt;</pre><h3>Character properties</h3><p>Character properties describe the qualities of individual characters. They are applied to elements that contain characters such as <code>fo:block</code> and <code>fo:list-item-body</code> elements. These include color, font, style, weight, and similar properties.</p><h4>The color property</h4><p>The <code>color</code> property sets the foreground color of the contents using the same syntax as the CSS <code>color</code> property. For example, this <code>fo:inline</code> colors the text &quot;Lions and tigers and bears, oh my!&quot; pink:</p><pre>&lt;fo:inline color="#FFCCCC"&gt;  Lions and tigers and bears, oh my!&lt;/fo:inline&gt;</pre><p>Colors are specified in much the same way as they are in CSS; that is, as hexadecimal triples in the form #RRGGBB or as one of the 16 named colors (<code>aqua</code>, <code>black</code>, <code>blue</code>, <code>fuchsia</code>, <code>gray</code>, <code>green</code>, <code>lime</code>, <code>maroon</code>, <code>navy</code>, <code>olive</code>, <code>purple</code>, <code>red</code>, <code>silver</code>, <code>teal</code>, <code>white</code>, and <code>yellow</code>).</p><h4>Font properties</h4><p>Any formatting object that holds text can have a wide range of font properties. Most of these are familiar from CSS, including the following:</p><ul><li><code>font-family</code>&#150;A list of font names in order of preference</li><li><code>font-size</code>&#150;A signed length</li><li><code>font-size-adjust</code>&#150;The preferred ratio between the x-height and size of a font, specified as an unsigned real number or as <code>none</li><li>font-stretch</code>&#150;The &quot;width&quot; of a font, given as one of the keywords <code>condensed</code>, <code>expanded</code>, <code>extra-condensed</code>, <code>extra-expanded</code>, <code>narrower</code>, <code>normal</code>, <code>semi-condensed</code>, <code>semi-expanded</code>, <code>ultra-condensed</code>, <code>ultra-expanded</code>, or <code>wider</li><li>font-style</code>&#150;The style of font specified as one of the keywords <code>italic</code>, <code>normal</code>, <code>oblique</code>, <code>reverse-normal</code>, or <code>reverse-oblique</li><li>font-variant</code>&#150;Either <code>normal</code> or <code>small-caps</li><li>font-weight</code>&#150;The thickness of the strokes that draw the font, given as one of the keywords <code>100</code>, <code>200</code>, <code>300</code>, <code>400</code>, <code>500</code>, <code>600</code>, <code>700</code>, <code>800</code>, <code>900</code>, <code>bold</code>, <code>bolder</code>, <code>lighter</code>, or <code>normal</li></code></ul><h4>Text properties</h4><p>The text properties apply styles to text that are more or less independent of the font chosen. These include the following:</p><ul><li><code>text-transform</li><li>text-shadow</li><li>text-decoration</li><li>score-spaces</li></code></ul><p>The <code>text-transform</code> property defines how text is capitalized, and is identical to the CSS property of the same name. The four possible values are as follows:</p><ul><li><code>none</code>&#150;Don&#146;t change the case (the default)</li><li><code>capitalize</code>&#150;Make the first letter of each word uppercase and all subsequent letters lowercase</li><li><code>uppercase</code>&#150;Make all characters uppercase</li><li><code>lowercase</code>&#150;Make all characters lowercase</li></ul><p>This property is somewhat language-specific. (Chinese and Hebrew, for example, don&#146;t have separate upper- and lowercases.) Formatters are free to ignore the case recommendations when they&#146;re applied to non-Roman text.</p><p>The <code>text-shadow</code> property applies a shadow to text. This is similar to a background color but differs in that the shadow is attached to the text itself rather than to the box containing the text. The value of <code>text-shadow</code> can be the keyword <code>none</code> or a named or RGB color. For example:</p><pre>&lt;fo:inline text-shadow="FFFF66"&gt;  This sentence is yellow.&lt;/fo:inline&gt;</pre><p>The <code>text-decoration</code> property is similar to the CSS <code>text-decoration</code> property. Like that property, it has these five possible values:</p><ul><li><code>none</code>&#150;No decoration, the default</li><li><code>underline</code>&#150;<u>Underlining</u></li></ul><ul></u><li><code>overline</code>&#150;A line above the text</li><li><code>line-through</code>&#150;<strike>Strike through</strike></li><li><code>blink</code>&#150;The notorious blinking text introduced by Netscape</li></ul><p>In addition to the five values that are familiar from CSS, XSL-FO also adds four values that turn off decoration that is inherited from a parent element:</p><ul><li><code>no-underline</code></li><li><code>no-overline</code></li><li><code>no-line-through</code></li><li><code>no-blink</code></li></ul><p>Scoring is a catchall word for <u>underlining</u>, <strike>line-through</strike>, double strike-through, and so forth. The <code>score-space</code> property determines whether white space is scored. <u>For example, if <code>score-spaces</code> is <code>true</code>, an underlined sentence looks like this.</u> <u>If</u> <u><code>score-spaces</u></code> <u>is</u> <u><code>false</u></code>, <u>an</u> <u>underlined</u> <u>sentence</u> <u>looks</u> <u>like</u> <u>this</u>.</p><h3>Sentence properties</h3><p>Sentence properties apply to groups of characters, that is, a property that makes sense only for more than one letter at a time, such as how much space to place between letters or words.</p><h4>Letter spacing properties</h4><p><i>Kerning</i> of text is a slippery measure of how much space separates two characters. It&#146;s not an absolute number. Most formatters adjust the space between letters based on local necessity, especially in justified text. Furthermore, high-quality fonts use different amounts of space between different glyphs. However, you can make text looser or tighter overall.</p><p>The <code>letter-spacing</code> property adds additional space between each pair of glyphs, beyond that provided by the kerning. It&#146;s given as a signed length specifying the desired amount of extra space to add, as in the following example:</p><pre>  &lt;fo:block letter-spacing="2px"&gt;    This is fairly loose text  &lt;/fo:block&gt;</pre><p>The length may be negative to tighten up the text. Formatters, however, generally impose limits on how much extra space they allow to be added to or removed from the space between letters.</p><h4>Word spacing properties</h4><p>The <code>word-spacing</code> property adjusts the amount of space between words. Otherwise, it behaves much like the letter spacing properties. The value is a signed length giving the amount of extra space to add between two words. For example:</p><pre>  &lt;fo:block word-spacing="0.3cm"&gt;    This is pretty loose text.  &lt;/fo:block&gt;</pre><h4>Line spacing properties</h4><p>An XSL-FO formatting engine divides block areas into line areas. You cannot create line areas directly from XSL-FO. However, with these five properties you can affect how they&#146;re vertically spaced:</p><ul><li><code>line-height</code>&#150;The minimum height of a line</li><li><code>line-height-shift-adjustment</code>&#150;<code>consider-shifts</code> if subscripts and superscripts should expand the height of a line; <code>disregard-shifts</code> if they shouldn&#146;t</li><li><code>line-stacking-strategy</code>&#150;<code>line-height</code> (the CSS model and the default); <code>font-height</code> (make the line as tall as the font height after addition of <code>text-altitude</code> and <code>text-depth</code>); or <code>max-height</code> (distance between the maximum ascender height and maximum descender depth)</li><li><code>text-depth</code>&#150;A signed length specifying additional vertical space added after each line; can also be the keyword <code>use-font-metrics</code> (the default) to indicate that this depends on the font</li><li><code>text-altitude</code>&#150;A signed length specifying the minimum additional vertical space added before each line; can also be the keyword <code>use-font-metrics</code> (the default) to indicate that this depends on the font</li></ul><p>The line height also depends largely on the size of the font in which the line is drawn. Larger font sizes will naturally have taller lines. For example, the following opening paragraph from Mary Wollstonecraft&#146;s <i>A Vindication of the Rights of Woman</i> is effectively double-spaced:</p><pre>&lt;fo:block font-size="12pt" line-height="24pt"&gt;  In the present state of society it appears necessary to go  back to first principles in search of the most simple truths,  and to dispute with some prevailing prejudice every inch of  ground. To clear my way, I must be allowed to ask some plain  questions, and the answers will probably appear as  unequivocal as the axioms on which reasoning is built;  though, when entangled with various motives of action, they  are formally contradicted, either by the words or conduct  of men.&lt;/fo:block&gt;</pre><h4>Text alignment properties</h4><p>The <code>text-align</code> and <code>text-align-last</code> properties specify how the inline content is horizontally aligned within its box. The eight possible values are as follows:</p><ul><li><code>start</code>&#150;Left-aligned in left-to-right languages such as English</li><li><code>center</code>&#150;Centered</li><li><code>end</code>&#150;Right-aligned in left-to-right scripts</li><li><code>justify</code>&#150;Expanded with extra space as necessary to fill out the line</li><li><code>left</code>&#150;Align with the left side of the page regardless of the writing direction</li><li><code>right</code>&#150;Align with the right side of the page regardless of the writing direction</li><li><code>inside</code>&#150;Align with the inside edge of the page; that is, the right edge on the left page of two facing pages or the left edge on the right page of two facing pages</li><li><code>outside</code>&#150;Align with the outside edge of the page; that is, the left edge on the left page of two facing pages or the right edge on the right page of two facing pages</li></ul><p>The <code>text-align-last</code> property enables you to specify a different value for the last line in a block. This is especially important for justified text, where the last line often doesn&#146;t have enough words to be attractively justified. The possible values are the same as for <code>text-align</code> plus <code>relative</code>. A relatively aligned last line will line up the same way as all other lines unless <code>text-align</code> is <code>justified</code>, in which case the last line will align with the start edge instead.</p><h4>White space properties</h4><p>The <code>space-treatment</code> property specifies what the formatting engine should do with white space that&#146;s still present after the original source document is transformed into formatting objects. It can be set to either <code>preserve</code> (the default) or <code>ignore</code>. If you set it to ignore, leading and trailing white space will be thrown away.</p><p>The <code>white-space-collapse</code> property can be set to <code>true</code> (the default) or <code>false</code>. When true, runs of white space are replaced by a single space. When false, they&#146;re left unchanged.</p><p>The <code>wrap-option</code> property determines how text that&#146;s too long to fit on a line is handled. This property can be set to <code>wrap</code> (the default) or <code>no-wrap</code>. When set to <code>wrap</code>, this allows the formatter to insert line breaks as necessary to fit the text.</p><h3>Area properties</h3><p>Area properties are applied to boxes. These may be either block-level or inline boxes. Each of these boxes has the following:</p><ul><li>A background</li><li>Margins</li><li>Borders</li><li>Padding</li><li>A size</li></ul><h4>Background properties</h4><p>The background properties are identical to the CSS background properties. There are five:</p><ul><li>The <code>background-color</code> property specifies the color of the box&#146;s background. Its value is either a color such as <code>red</code> or <code>#FFCCCC</code> or the keyword <code>transparent</code>.</li><li>The <code>background-image</code> property gives the URI of an image to be used as a background. The value can also be the keyword <code>none</code>.</li><li>The <code>background-attachment</code> property specifies whether the background image is attached to the window or the document. Its value is one of the two keywords <code>fixed</code> or <code>scroll</code>.</li><li>The <code>background-position</code> property specifies where the background image is placed in the box. Possible values include <code>center</code>, <code>left</code>, <code>right</code>, <code>bottom</code>, <code>middle</code>, <code>top</code>, or a coordinate.</li><li>The <code>background-repeat</code> property specifies how and whether a background image is tiled if it is smaller than its box. Possible values include <code>repeat</code>, <code>no-repeat</code>, <code>repeat-x</code>, and <code>repeat-y</code>.</li></ul><p>The following block shows the use of the <code>background-image</code>, <code>background-position</code>, <code>background-repeat</code>, and <code>background-color</code> properties:</p><pre>&lt;fo:block background-image="/bg/paper.gif"          background-position="0,0"          background-repeat="repeat"          background-color="white"&gt;  Two strings walk into a bar...&lt;/fo:block&gt;</pre><dir><b><font face="Arial" size=1 color="#000080"><p>Caution</p></b></font><p>The only background properties FOP 0.20.5 supports are <code>background-color</code> and <code>background-image</code>. The others will probably be added in future releases.</p></dir><h4>Border properties</h4><p>The border properties describe the appearance of a border around the box. They are mostly the same as the CSS border properties. However, in addition to <code>border-<i>XXX</i>-bottom</code>, <code>border-<i>XXX</i>-top</code>, <code>border-<i>XXX</i>-left</code>, and <code>border-<i>XXX</i>-right</code> properties, the XSL versions also have <code>border-<i>XXX</i>-before</code>, <code>border-<i>XXX</i>-after</code>, <code>border-<i>XXX</i>-start</code>, and <code>border-<i>XXX</i>-end</code> versions. There are 31 border properties in all:</p><ul><li>Color&#150;<code>border-color</code>, <code>border-before-color</code>, <code>border-after-color</code>, <code>border-start-color</code>, <code>border-end-color</code>, <code>border-top-color</code>, <code>border-bottom-color</code>,<code> border-left-color</code>, and <code>border-right-color</code>. The default color is black.</li><li>Width&#150;<code>border-width</code>, <code>border-before-width</code>, <code>border-after-width</code>, <code>border-start-width</code>, <code>border-end-width</code>, <code>border-top-width</code>, <code>border-bottom-width</code>,<code> border-left-width</code>, and <code>border-right-width</code>. The default width is <code>medium</code>.</li><li>Style&#150;<code>border-style</code>, <code>border-before-style</code>, <code>border-after-style</code>, <code>border-start-style</code>, <code>border-end-style</code>, <code>border-top-style</code>, <code>border-bottom-style</code>,<code> border-left-style</code>, <code>border-right-style</code>. The default style is <code>none</code>.</li><li>Shorthand properties&#150;<code>border</code>, <code>border-top</code>, <code>border-bottom</code>, <code>border-left</code>, <code>border-right</code>, <code>border-color</code>, <code>border-style</code>, <code>border-width</code>.</li></ul><p>For example, this block has a 2-pixel-wide blue border:</p><pre>&lt;fo:block border-before-color="blue" border-before-width="2px"          border-after-color="blue"  border-after-width="2px"          border-start-color="blue"  border-start-width="2px"          border-end-color="blue"    border-end-width="2px"&gt;  You have been selected for Special High Intensity Training.&lt;/fo:block&gt;</pre><h4>Padding properties</h4><p>The padding properties specify the amount of space between the border of the box and the contents of the box. The border of the box, if shown, falls between the margin and the padding. The padding properties are mostly the same as the CSS padding properties. However, in addition to <code>padding-bottom</code>, <code>padding-top</code>, <code>padding-left</code>, and <code>padding-right</code>, the XSL-FO versions also have <code>padding-before</code>, <code>padding-after</code>, <code>padding-start</code>, and <code>padding-end</code> versions. In total, there are eight padding properties, each of which has a signed length for a value:</p><ul><li><code>padding-after</li><li>padding-before</li><li>padding-bottom</li><li>padding-end</li><li>padding-left</li><li>padding-start</li><li>padding-right</li><li>padding-top</li></code></ul><p>For example, this block has half a centimeter of padding on each side:</p><pre>&lt;fo:block padding-before="0.5cm" padding-after="0.5cm"          padding-start="0.5cm"  padding-end="0.5cm"&gt;  Did you hear the one about the dyslexic agnostic?&lt;/fo:block&gt;</pre><h4>Margin properties for blocks</h4><p>There are five margin properties, each of whose values is given as an unsigned length.</p><ul><li><code>margin-top</li><li>margin-bottom</li><li>margin-left</li><li>margin-right</li><li>margin</li></code></ul><p>However, these properties are only here for compatibility with CSS. In general, it&#146;s recommended that you use these four properties instead, because they fit better in the XSL-FO formatting model:</p><ul><li><code>space-before</li><li>space-after</li><li>start-indent</li><li>end-indent</li></code></ul><p>The <code>space-before</code> and <code>space-after</code> properties are equivalent to the <code>margin-top</code> and <code>margin-bottom</code> properties, respectively. The <code>start-indent</code> property is equivalent to the sum of <code>padding-left</code>, <code>border-left-width</code>, and <code>margin-left</code>. The <code>end-indent</code> property is equivalent to the sum of <code>padding-right</code>, <code>border-right-width</code>, and <code>margin-right</code>. Figure 16-11 should make this clearer.</p><p><img src="picture21.jpg"></p><p>Figure 16-12: Padding, indents, borders, and space before and after for an XSL box</p><p>For example, this block has a half-centimeter margin at its start and end sides:</p><pre>&lt;fo:block start-indent="0.5cm" end-indent="0.5cm"&gt;  Two strings walk into a bar...&lt;/fo:block&gt;</pre><p>However, unlike margins, space properties are given as space specifiers that contain more than one value. In particular, they contain a preferred value, a minimum value, a maximum value, a conditionality, and a precedence. This allows the formatter somewhat more freedom in laying out the page. The formatter is free to pick any amount of space between the minimum and maximum to fit the constraints of the page.</p><p>Each of the space values is a length. The conditionality is one of the two keywords <code>discard</code> or <code>retain</code>. This determines what happens to extra space at the end of a line. The default is to discard it. The precedence can either be an integer or the keyword <code>force</code>. The precedence determines what happens when the <code>space-end</code> of one inline area conflicts with the <code>space-start</code> of the next. The area with higher precedence wins. The default precedence is 0. Semicolons separate all five values.</p><p>For example, consider this <code>fo:block</code> element:</p><pre>&lt;fo:block space-before="0in;0.5in;0.166in;discard;force"&gt; It goes to 11.&lt;/fo:block&gt;</pre><p>It says that, ideally, the formatter should add a sixth of an inch of space before this element. However, it can add as little as no space at all and as much as half an inch if necessary. Because the precedence is set to <code>force</code>, this will override any other space specifiers that conflict with it. Finally, if there&#146;s any extra space that&#146;s left over at the end, it will be discarded.</p><h4>Margin properties for inline boxes</h4><p>Two margin properties apply only to inline elements:</p><ul><li><code>space-end</li><li>space-start</li></code></ul><p>Their values are space specifiers that give a range of extra space to be added before and after the element. The actual spaces may be smaller or larger. Because the space is not part of the box itself, one box&#146;s end space can be part of the next box&#146;s start space.</p><h4>Size properties</h4><p>Six properties specify the height and width of the content area of a box:</p><ul><li><code>height</li><li>width</li><li>max-height</li><li>max-width</li><li>min-height</li><li>min-width</li></code></ul><p>These properties do not specify the total width and height of the box, which also includes the margins, padding, and borders. This is only the width and height of the content area. As well as an unsigned length, the <code>height</code> and <code>width</code> properties may be set to the keyword <code>auto</code>, which chooses the height and width based on the amount of content in the box. However, in no case are the height and width larger than the values specified by the <code>max-height</code> and <code>max-width</code> or smaller than the <code>min-height</code> and <code>min-width</code>. For example:</p><pre>&lt;fo:block height="2in" width="2in"&gt;  Two strings walk into a bar...&lt;/fo:block&gt;</pre><h4>The overflow properties</h4><p>The <code>overflow</code> property determines what happens when there&#146;s too much content to fit within a box of a specified size. This may be an explicit specification using the size properties or an implicit specification based on page size or other constraints. There are six possibilities, each of which is represented by a keyword:</p><ul><li><code>auto</code>&#150;Use scroll bars if there is overflow; don&#146;t use them if there isn&#146;t. If scroll bars aren&#146;t available (for example, on a printed page), add a new page for flow content and generate an error for static content. This is the default.</li><li><code>hidden</code>&#150;Don&#146;t show any content that runs outside the box.</li><li><code>scroll</code>&#150;Attach scroll bars to the box so the reader can scroll to the additional content.</li><li><code>visible</code>&#150;The complete contents are shown; if necessary, by overriding the size constraints on the box.</li><li><code>error-if-overflow</code>&#150;The formatter should give up and display an error message if content overflows its box.</li><li><code>paginate</code>&#150;If the object overflowed is a page, create a new page to hold the excess content.</li></ul><p>The <code>clip</code> property specifies the shape of the clipping region if the <code>overflow</code> property does not have the value <code>visible</code>. The default clipping region is simply the box itself. However, you can change this by specifying a particular rectangle, like this:</p><pre>clip=rect(<i>top_offset right_offset bottom_offset left_offset</i>)</pre><p>Here, <i><code>top_offset</i></code>, <i><code>right_offset</i></code>, <i><code>bottom_offset</i></code>, and <i><code>left_offset</i></code> are signed lengths giving the offsets of the clipping region from the top, right, bottom, and left sides of the box. This allows you to make the clipping region larger or smaller than the box itself.</p><h4>The reference-orientation property</h4><p>The <code>reference-orientation</code> property allows you to specify that the content of a box is rotated relative to its normal orientation. The only valid values are 90-degree increments, which are measured counterclockwise from the orientation of the parent container, that is, <code>0</code>, <code>90</code>, <code>180</code>, and <code>270</code>. You can also specify <code>-90</code>, <code>-180</code>, and <code>-270</code>. For example, here&#146;s a 90-degree rotation:</p><pre>&lt;fo:block reference-orientation="90"&gt;  Bottom to Top&lt;/fo:block&gt;</pre><h4>Writing mode properties</h4><p>The writing mode specifies the direction of text in the box. This has important implications for the ordering of formatting objects in the box. Most of the time, speakers of English and other Western languages assume a left-to-right, top-to-bottom writing mode, such as this:</p><pre>A B C D E F GH I J K L M NO P Q R S T UV W X Y Z</pre><p>However, in the Hebrew and Arabic-speaking worlds, a right-to-left, top-to-bottom ordering such as this one seems more natural:</p><pre>G F E D C B AN M L K J I HU T S R Q P OZ Y X W V</pre><p>In Taiwan, a top-to-bottom, left-to-right order is conventional:</p><pre>A E I M Q U YB F J N R V ZC G K O S WD H L P T X</pre><p>In XSL-FO, the writing mode doesn&#146;t just affect text. It also affects how objects in a flow or sequence are laid out, how wrapping is performed, and more. You&#146;ve already noticed that many properties are organized in start, end, before, and after variations instead of left, right, top, and bottom. Specifying style rules in terms of start, end, before, and after, instead of left, right, top, and bottom, produces more robust, localizable style sheets.</p><p>The <code>writing-mode</code> property specifies the writing mode for an area. This property can have 1 of 13 keyword values. These are as follows:</p><ul><li><code>bt-lr</code>&#150;Bottom-to-top, left-to-right</li><li><code>bt-rl</code>&#150;Bottom-to-top, right-to-left</li><li><code>lr-alternating-rl-bt</code>&#150;Left-to-right lines alternating with right-to-left lines, bottom to top</li><li><code>lr-alternating-rl-tb</code>&#150;Left-to-right lines alternating with right-to-left lines, top to bottom</li><li><code>lr-bt</code>&#150;Left to right, bottom to top</li><li><code>lr-inverting-rl-bt</code>&#150;Left to right, then move up to the next line and go right to left (that is, snake up the page like a backward S)</li><li><code>lr-inverting-rl-tb</code>&#150;Left to right, then move down to the next line and go right to left (that is, snake down the page like a backward S)</li><li><code>lr-tb</code>&#150;Left to right, top to bottom</li><li><code>rl-bt</code>&#150;Right to left, bottom to top</li><li><code>rl-tb</code>&#150;Right to left, top to bottom</li><li><code>tb-lr</code>&#150;Top to bottom, left to right</li><li><code>tb-rl</code>&#150;Top to bottom, right to left</li><li><code>tb-rl-in-rl-pairs</code>&#150;Text is written in two-character, right-to-left pairs; the pairs are then laid out top-to-bottom to form a line; lines are laid out from right to left</li></ul><h4>Orphans and widows</h4><p>To a typesetter, an orphan is a single line of a paragraph at the bottom of a page. A widow is a single line of a paragraph at the top of a page. Good typesetters move an extra line from the previous page to the next page or from the next page to the previous page, as necessary, to avoid orphans and widows. You can adjust the number of lines considered an orphan by setting the <code>orphans</code> property to an unsigned integer. You can adjust the number of lines considered a widow by setting the <code>widows</code> property to an unsigned integer. For example, if you want to make sure that every partial paragraph at the end of a page has at least three lines, set the <code>orphans</code> property to 3, as follows:</p><pre>&lt;fo:simple-page-master master-name="even"    orphans="3" page-height="11in" page-width="8.5in"/&gt;</pre><h2>Summary</h2><p>In this chapter, you learned about XSL formatting objects. In particular, you learned the following:</p><ul><li>An XSL processor follows the instructions in an XSLT style sheet to transform an XML source document into a new XML document marked up in the XSL formatting object vocabulary.</li><li>Most XSL formatting objects generate one or more rectangular areas. Pages contain regions. Regions contain block areas. Block areas contain block areas and line areas. Line areas contain inline areas. Inline areas contain other inline areas and character areas.</li><li>The root element of a formatting object document is <code>fo:root</code>. This contains <code>fo:layout-master-set</code> elements and <code>fo:page-sequence</code> elements.</li><li>Each <code>fo:layout-master-set</code> element contains one or more <code>fo:simple-page-master elements</code>, each of which defines the layout of a particular kind of page by dividing it into five regions (before, after, start, end, and body) and assigning properties to each one. It may also contain one or more <code>fo:page-sequence-master</code> elements.</li><li>Each <code>fo:page-sequence</code> element contains zero or one <code>fo:title</code> elements, zero or more <code>fo:static-content</code> elements, one or more <code>fo:flow</code> elements, and a <code>master-reference</code> attribute. The contents of the <code>fo:flow</code> are copied onto instances of the master pages in the order specified by the <code>fo:page-sequence-master</code> element identified by the <code>master-reference</code> attribute. The contents of the <code>fo:static-content</code> elements are copied onto every page that&#146;s created.</li><li>The <code>fo:external-graphic</code> element loads an image from a URL and displays it inline.</li><li>The <code>fo:instream-foreign-object</code> element displays an image encoded in a non-XSL-FO XML application, such as SVG or MathML. The code is included in the XSL-FO document along with the XSL-FO code.</li><li>The <code>fo:basic-link</code> element creates a hypertext link to a URL.</li><li>A list is a block-level element created by a <code>fo:list-block</code> element. It contains block-level <code>fo:list-item</code> elements. Each <code>fo:list-item</code> contains a <code>fo:list-item-label</code> and <code>fo:list-item-body</code>, and each of these contains block-level elements.</li><li>The <code>fo:page-number</code> element inserts the current page number.</li><li>The <code>fo:inline</code> element is a container used to attach properties to the text and areas it contains.</li><li>The <code>fo:footnote</code> element inserts an out-of-line footnote and an inline footnote reference into the page.</li><li>The <code>fo:float</code> element inserts an out-of-line, block-level element such as a figure or a pull quote onto the page. The <code>float</code> property determines which side other elements are allowed to float around it.</li><li>There are more than 200 separate XSL formatting properties, many of which are identical to CSS properties of the same name. These are attached to XSL formatting object elements as attributes.</li><li>The keeps and breaks properties describe where page breaks are required and forbidden. These include <code>keep-with-next</code>, <code>keep-with-previous</code>, <code>keep-together</code>, <code>break-before</code>, <code>break-after</code>, <code>widows</code>, and <code>orphans</code>.</li><li>The hyphenation properties describe whether and how to insert soft hyphens. These include <code>hyphenate</code>, <code>hyphenation-character</code>, <code>hyphenation-keep</code>, <code>hyphenation-ladder-count</code>, <code>hyphenation-push-character-count</code>, and <code>hyphenation-remain-character-count</code>.</li><li>The indent properties specify how far lines are indented from the edge of the text. There are four of these: <code>start-indent</code>, <code>end-indent</code>, <code>text-indent</code>, and <code>last-line-end-indent</code>.</li><li>Character properties describe attributes of individual characters and include <code>color</code>, <code>font-family</code>, <code>font-size</code>, <code>font-size-adjust</code>, <code>font-stretch</code>, <code>font-style</code>, <code>font-variant</code>, <code>font-weight</code>, <code>text-transform</code>, <code>text-shadow</code>, <code>text-decoration</code>, and <code>score-space</code>.</li><li>Sentence properties describe formatting that only makes sense for groups of letters and words and include <code>letter-spacing</code>, <code>word-spacing</code>, <code>line-height</code>, <code>line-height-shift-adjustment</code>, <code>line-stacking-strategy</code>, <code>text-depth</code>, <code>text-altitude</code>, <code>text-align</code>, <code>text-align-last</code>, <code>space-treatment</code>, <code>white-space-collapse</code>, and <code>wrap-option</code>.</li><li>Area properties describe attributes of boxes produced by various formatting objects, and include the background, border, padding, and margin properties.</li></ul><p>The next chapter introduces XLinks, a more powerful linking syntax than the standard HTML <code>A</code> element hyperlinks and XSL&#146;s <code>fo:basic-link</code>.</p>   <hr />From XML 1.1 Bible, by <a href="http://www.elharo.com/">Elliotte Rusty Harold</a>. &copy; 2004 byWiley Publishing, Inc.  All rights reserved.  Reproduced here by permissionof the publisher.      <hr />      <div style="text-align: center">                [ <a href="../../index.html">Cafe con Leche</a>          | <a href="../index.html">XML Bible Home Page</a>       | Order  from  <a href="http://www.amazon.com/exec/obidos/ASIN/0764549863/ref=nosim/cafeaulaitA/">amazon.com</a>  |  <a href="http://www.wiley.com/WileyCDA/WileyTitle/productCd-0764549863.html">Publisher Page</a> ]         </div></body></html>