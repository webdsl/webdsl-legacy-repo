section domain

  entity BlogEntry {
    key       :: String (id)
    title     :: String
    author    -> User
    body      :: WikiText
  }

  entity Blog {
    key        :: String (id)
    title      :: String (name)
    topic      :: String
    removable  :: String
    entries    -> List<BlogEntry>
  }

transformations

	BlogEntryTransformation = 
		BlogEntry
		removeProperty(author)
		propertySimpleTypeChange(body, String)

	BlogTransformation = 
		Blog
		keep (key, title, topic, entries)
		addPropertyDefaultValue
			subtitle :: String ("defaultSubTitle")
		addProperty
			subtitleWhichIsSetToTheTitle :: String (current.title)
		restrict (true)
		removeProperty(topic)
		propertyNameChange(entries, blogEntries)
		propertySimpleTypeChange
			key :: String
		propertyReferenceTypeChange(entries, List<BlogEntry>, $BlogEntryTransformation)

	transform
		Blog
		merge (	
			i1.key = i2.key,
			Blog
			removeProperty(topic)
			removeProperty(entries)
			propertyNameChange(title, subTitle)
		)
		BlogWithTitleAsSubtitle
	
	transform
		$BlogTransformation
		Blog
	
	transform
		$BlogEntryTransformation
		
	transform
		emptyEntity
		newEntityName
