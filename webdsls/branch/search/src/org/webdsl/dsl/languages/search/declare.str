module org/webdsl/dsl/languages/search/declare

imports
  libstrategolib

imports
  libwebdsl-front
  libjava-front
  org/webdsl/dsl/languages/search/-

rules

declare-search:
	s@SearchMapping(x_class, body) -> s
	with rules(
		SearchMappingForEnt :+ x_class -> SearchMappingEmbedded(body)
		IndexedEntity : x_class
		)

declare-native-search-query-class:
	x_class -> x_class
	with query_class_name := <concat-strings> [x_class, "SearchQuery"] 
		;debug ; <declare>
		NativeClass(
			Qualified(Qualified(Qualified("webdsl","generated"),"domain"),query_class_name),
			NativeClassAlias(query_class_name),
			None(),
			[
				NativeClassConstructor([]),
				NativeClassFunction(None(),"allowLuceneSyntax",[NativeSimpleType("Bool")],NativeClassFunctionReturn(NativeSimpleType(query_class_name))),
				NativeClassFunction(None(),"addFieldConstraint",[NativeSimpleType("String"),NativeSimpleType("String")],NativeClassFunctionReturn(NativeSimpleType(query_class_name))),
				NativeClassFunction(NativeClassFunctionStatic(),"autoCompleteSuggest",[NativeSimpleType("String"),NativeSimpleType("String"),NativeSimpleType("Int")],NativeClassFunctionReturn(NativeGenericType("List",[NativeSimpleType("String")]))),
				NativeClassFunction(NativeClassFunctionStatic(),"autoCompleteSuggest",[NativeSimpleType("String"),NativeGenericType("List",[NativeSimpleType("String")]),NativeSimpleType("Int")],NativeClassFunctionReturn(NativeGenericType("List",[NativeSimpleType("String")]))),
				NativeClassFunction(NativeClassFunctionStatic(),"spellSuggest",[NativeSimpleType("String"),NativeGenericType("List",[NativeSimpleType("String")]),NativeSimpleType("Float"),NativeSimpleType("Int")],NativeClassFunctionReturn(NativeGenericType("List",[NativeSimpleType("String")]))),
				NativeClassFunction(NativeClassFunctionStatic(),"spellSuggest",[NativeSimpleType("String"),NativeSimpleType("String"),NativeSimpleType("Float"),NativeSimpleType("Int")],NativeClassFunctionReturn(NativeGenericType("List",[NativeSimpleType("String")]))),
				NativeClassFunction(None(),"boost",[NativeSimpleType("String"),NativeSimpleType("Float")],NativeClassFunctionReturn(NativeSimpleType(query_class_name))),
				NativeClassFunction(None(),"defaultAnd",[],NativeClassFunctionReturn(NativeSimpleType(query_class_name))),
				NativeClassFunction(None(),"defaultOr",[],NativeClassFunctionReturn(NativeSimpleType(query_class_name))),
				NativeClassFunction(None(),"facets",[NativeSimpleType("String"),NativeSimpleType("Int")],NativeClassFunctionReturn(NativeGenericType("List",[NativeSimpleType("Facet")]))),
				NativeClassFunction(None(),"rangeFacets",[NativeSimpleType("String"),NativeSimpleType("String")],NativeClassFunctionReturn(NativeGenericType("List",[NativeSimpleType("Facet")]))),
				NativeClassFunction(None(),"narrowOnFacet",[NativeSimpleType("Facet")],NativeClassFunctionReturn(NativeSimpleType(query_class_name))),
				NativeClassFunction(None(),"field",[NativeSimpleType("String")],NativeClassFunctionReturn(NativeSimpleType(query_class_name))),
				NativeClassFunction(None(),"fields",[NativeGenericType("List",[NativeSimpleType("String")])],NativeClassFunctionReturn(NativeSimpleType(query_class_name))),
				NativeClassFunction(None(),"firstResult",[NativeSimpleType("Int")],NativeClassFunctionReturn(NativeSimpleType(query_class_name))),
				NativeClassFunction(None(),"maxResults",[NativeSimpleType("Int")],NativeClassFunctionReturn(NativeSimpleType(query_class_name))),
				NativeClassFunction(None(),"highlight",[NativeSimpleType("String"),NativeSimpleType("String")],NativeClassFunctionReturn(NativeSimpleType("String"))),
				NativeClassFunction(None(),"highlight",[NativeSimpleType("String"),NativeSimpleType("String"),NativeSimpleType("String"),NativeSimpleType("String")],NativeClassFunctionReturn(NativeSimpleType("String"))),
				NativeClassFunction(None(),"moreLikeThis",[NativeSimpleType("String")],NativeClassFunctionReturn(NativeSimpleType(query_class_name))),
				NativeClassFunction(None(),"terms",[],NativeClassFunctionReturn(NativeSimpleType("String"))),
				NativeClassFunction(None(),"terms",[NativeSimpleType("String")],NativeClassFunctionReturn(NativeSimpleType(query_class_name))),
				NativeClassFunction(None(),"sortDesc",[NativeSimpleType("String")],NativeClassFunctionReturn(NativeSimpleType(query_class_name))),
				NativeClassFunction(None(),"sortAsc",[NativeSimpleType("String")],NativeClassFunctionReturn(NativeSimpleType(query_class_name))),
				NativeClassFunction(None(),"range",[NativeSimpleType("Int"),NativeSimpleType("Int")],NativeClassFunctionReturn(NativeSimpleType(query_class_name))),
				NativeClassFunction(None(),"range",[NativeSimpleType("Float"),NativeSimpleType("Float")],NativeClassFunctionReturn(NativeSimpleType(query_class_name))),
				NativeClassFunction(None(),"range",[NativeSimpleType("Date"),NativeSimpleType("Date")],NativeClassFunctionReturn(NativeSimpleType(query_class_name))),
				NativeClassFunction(None(),"list",[],NativeClassFunctionReturn(NativeGenericType("List",[NativeSimpleType(x_class)]))),
				NativeClassFunction(None(),"resultSize",[],NativeClassFunctionReturn(NativeSimpleType("Int"))),
				NativeClassFunction(None(),"searchTimeAsString",[],NativeClassFunctionReturn(NativeSimpleType("String"))),
				NativeClassFunction(None(),"searchTimeMillis",[],NativeClassFunctionReturn(NativeSimpleType("Int"))),
				NativeClassFunction(None(),"searchTimeSeconds",[],NativeClassFunctionReturn(NativeSimpleType("Float")))
			]
		)

		