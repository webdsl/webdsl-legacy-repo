module modules

rules

  desugar-all =
    innermost(desugar)
  
  declare-all =
    desugar-all;
    declare-primitive-types;
    declare-module
    
rules

  declare-module :
    Module(x, d1*) -> Module(x, d2*)
    where d2* := <declare-top-level> d1*
    
  declare-top-level =
    {| EntityDeclaration, Template
     : map(declare-def)
     ; map(rename-all)
     |}
    ; alltd(declare-def)

  rename-all =
    alltd(rename)
    
  module-name :
    Module(x, d*) -> x
    