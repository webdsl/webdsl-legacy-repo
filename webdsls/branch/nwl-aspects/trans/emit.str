module emit

imports libstratego-aterm libstratego-gpp
imports include/nwl

rules // desugared builder
    
  emit: def -> def
    with rules(Emit :+= def)
    
  retrieve-emits =
    bagof-Emit;
    rules(Emit :- _)
  
  add-emits: Module(x, def1*) -> Module(x, mod2*)
    with  emit* := <retrieve-emits>;
          mod2* := [def1*, emit*]
          