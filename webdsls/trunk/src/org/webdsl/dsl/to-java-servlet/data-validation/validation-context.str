module org/webdsl/dsl/to-java-servlet/data-validation/validation-context

imports 
  libstrategolib  
  libjava-front
  libwebdsl-front
 
rules //for use in input element translation

  wrap-validation-context-code-store-inputs :
    bstm* ->
    bstm* |[
      ThreadLocalPage.get().enterValidationContext(ident);
      bstm* 
      ThreadLocalPage.get().leaveValidationContext();
    ]|

  validation-context-wrapper-for-input(s) :
    tc ->
    <for-loop-counter-wrap-code> 
    bstm*|[
      ident = e_id;
      ~*<?[] <+ wrap-validation-context-code-store-inputs> bstm* |[
        bstm* 
      ]|
    ]|
    where TemplateCall(_, [arg],passign*, TemplateBody(elem*)) := tc
       <+ SelectFromList(e1, e7, passign*, elem*) := tc
       <+ Select(x, srt, label, e, passign*, elem*) := tc
    with  inputident := <get-inputnumber> tc
        ; bstm* := <collect-om(s);concat-with-sublists> elem*
        ; e_id := <id-encoding> inputident
    